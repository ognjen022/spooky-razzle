{"ast":null,"code":"var _jsxFileName = \"/Users/ognjen/Desktop/spooky.live-ssr/src/components/VideoPlayer/VideoPlayerDefault.tsx\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { videoPlayerStreamRequested } from '../../services/content/videoPlayer/events';\nimport { selectVideoPlayerStream, selectVideoPlayerToken } from '../../services/content/videoPlayer/selectors';\n\nconst VideoPlayerDefault = (props, context) => {\n  const videoPlayer = /*#__PURE__*/React.createRef();\n  const {\n    0: player,\n    1: setPlayer\n  } = useState(undefined);\n  const token = useSelector(state => selectVideoPlayerToken(state.content.videoPlayer));\n  const stream = useSelector(state => selectVideoPlayerStream(state.content.videoPlayer));\n  const dispatch = useDispatch();\n  useEffect(() => {\n    setPlayer(new window.THEOplayer.Player(videoPlayer.current, {\n      libraryLocation: \"https://cdn.myth.theoplayer.com/8cc4421d-4ada-4a2c-8477-341e25036483/\"\n    }));\n  }, []);\n  useEffect(() => {\n    if (player !== null && player) {\n      var _videoPlayer$current, _videoPlayer$current2, _videoPlayer$current3, _videoPlayer$current4, _videoPlayer$current5, _videoPlayer$current6, _videoPlayer$current7, _videoPlayer$current8, _videoPlayer$current9, _videoPlayer$current10;\n\n      dispatch(videoPlayerStreamRequested(props.eventId, props.videoId, props.isLive));\n      player.addEventListener('timeupdate', ev => {\n        const elapsed = player.duration === 'Infinity' ? ev.currentTime : player.duration - ev.currentTime;\n\n        if (props.onTimeUpdate) {\n          props.onTimeUpdate(elapsed);\n        }\n      });\n      const bigPlay = (_videoPlayer$current = videoPlayer.current) === null || _videoPlayer$current === void 0 ? void 0 : _videoPlayer$current.querySelector('#bigPlay svg');\n      const theoPlay = (_videoPlayer$current2 = videoPlayer.current) === null || _videoPlayer$current2 === void 0 ? void 0 : _videoPlayer$current2.querySelector('.theo-big-play-button-svg-container > svg');\n      const spookySpinner = (_videoPlayer$current3 = videoPlayer.current) === null || _videoPlayer$current3 === void 0 ? void 0 : _videoPlayer$current3.querySelector('#spookySpinner svg');\n      const theoSpinner = (_videoPlayer$current4 = videoPlayer.current) === null || _videoPlayer$current4 === void 0 ? void 0 : _videoPlayer$current4.querySelector('.theo-loading-spinner-rotator');\n      (_videoPlayer$current5 = videoPlayer.current) === null || _videoPlayer$current5 === void 0 ? void 0 : (_videoPlayer$current6 = _videoPlayer$current5.querySelector('.theo-big-play-button-svg-container')) === null || _videoPlayer$current6 === void 0 ? void 0 : _videoPlayer$current6.replaceChild(bigPlay, theoPlay); // videoPlayer.current?.querySelector('.theo-secondary-color.vjs-loading-spinner ')\n      // ?.replaceChild(spookySpinner, theoSpinner);\n\n      (_videoPlayer$current7 = videoPlayer.current) === null || _videoPlayer$current7 === void 0 ? void 0 : (_videoPlayer$current8 = _videoPlayer$current7.querySelector('.theo-cast-button.theo-chromecast-button.theo-controlbar-button.vjs-control.vjs-button')) === null || _videoPlayer$current8 === void 0 ? void 0 : _videoPlayer$current8.remove();\n      (_videoPlayer$current9 = videoPlayer.current) === null || _videoPlayer$current9 === void 0 ? void 0 : (_videoPlayer$current10 = _videoPlayer$current9.querySelector('.theo-cast-button.theo-airplay-button.theo-controlbar-button.vjs-control.vjs-button')) === null || _videoPlayer$current10 === void 0 ? void 0 : _videoPlayer$current10.remove();\n    }\n  }, [player]);\n  useEffect(() => {\n    if (token && stream && player !== null && player) {\n      var _props$position;\n\n      let source = {\n        src: undefined,\n        type: 'application/x-mpegurl' // sets type to HLS\n\n      };\n      let param = `?timestamp=${token.timestamp}&token=${token.token}&clientId=${token.client_id}`;\n\n      if (stream.vods.data.length > 0) {\n        source.src = `${stream.vods.data[0].data.m3u8}${param}`;\n      } else if (stream.live !== null) {\n        source.src = `${stream.live.m3u8}${param}`;\n      }\n\n      player.source = {\n        sources: [source]\n      };\n\n      if ((_props$position = props.position) !== null && _props$position !== void 0 ? _props$position : 0 !== 0) {\n        player.currentTime = props.position;\n      }\n\n      player.play();\n    }\n  }, [stream, token]);\n  const hide = {\n    display: 'none'\n  };\n  return __jsx(\"div\", {\n    ref: videoPlayer,\n    className: 'spooky-player theoplayer-container video-js theoplayer-skin vjs-16-9 THEOplayer',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, __jsx(\"span\", {\n    id: \"bigPlay\",\n    style: hide,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, __jsx(\"svg\", {\n    className: 'big-play',\n    role: \"presentation\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, __jsx(\"use\", {\n    xlinkHref: \"#icon-play\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }\n  }))), __jsx(\"span\", {\n    id: \"spookySpinner\",\n    style: hide,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, __jsx(\"svg\", {\n    className: 'spooky-spinner',\n    role: \"presentation\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, __jsx(\"use\", {\n    xlinkHref: \"#icon-spinner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 17\n    }\n  }))));\n};\n\nexport default VideoPlayerDefault;","map":{"version":3,"sources":["/Users/ognjen/Desktop/spooky.live-ssr/src/components/VideoPlayer/VideoPlayerDefault.tsx"],"names":["React","useEffect","useState","useDispatch","useSelector","videoPlayerStreamRequested","selectVideoPlayerStream","selectVideoPlayerToken","VideoPlayerDefault","props","context","videoPlayer","createRef","player","setPlayer","undefined","token","state","content","stream","dispatch","window","THEOplayer","Player","current","libraryLocation","eventId","videoId","isLive","addEventListener","ev","elapsed","duration","currentTime","onTimeUpdate","bigPlay","querySelector","theoPlay","spookySpinner","theoSpinner","replaceChild","remove","source","src","type","param","timestamp","client_id","vods","data","length","m3u8","live","sources","position","play","hide","display"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { videoPlayerStreamRequested } from '../../services/content/videoPlayer/events';\nimport { IVideoStreamResponse, IVideoTokenResponse } from '../../services/content/videoPlayer/models';\nimport { selectVideoPlayerStream, selectVideoPlayerToken } from '../../services/content/videoPlayer/selectors';\nimport { RootState } from '../../services/RootState';\n\nimport { IVideoPlayerProps } from './VideoPlayer';\n\nconst VideoPlayerDefault: React.FC<IVideoPlayerProps> = (props: IVideoPlayerProps, context: any) => {\n\n    const videoPlayer = React.createRef<HTMLDivElement>();\n\n    const [player, setPlayer] = useState<any>(undefined);\n\n    const token = useSelector<RootState, IVideoTokenResponse | undefined>(state => selectVideoPlayerToken(state.content.videoPlayer))\n    const stream = useSelector<RootState, IVideoStreamResponse | undefined>(state => selectVideoPlayerStream(state.content.videoPlayer))\n\n    const dispatch = useDispatch();\n    useEffect(() => {\n        setPlayer(new (window as any).THEOplayer.Player(videoPlayer.current, {\n            libraryLocation: \"https://cdn.myth.theoplayer.com/8cc4421d-4ada-4a2c-8477-341e25036483/\"\n        }));\n    }, [])\n\n    useEffect(() => {\n        if (player !== null && player) {\n            dispatch(videoPlayerStreamRequested(\n                props.eventId,\n                props.videoId,\n                props.isLive\n            ));\n            (player as any).addEventListener('timeupdate', ev => {\n                const elapsed = (player as any).duration === 'Infinity' ? ev.currentTime : (player as any).duration - ev.currentTime;\n                if (props.onTimeUpdate) {\n                    props.onTimeUpdate(elapsed)\n                }\n            });\n            const bigPlay = videoPlayer.current?.querySelector('#bigPlay svg') as any;\n            const theoPlay = videoPlayer.current?.querySelector('.theo-big-play-button-svg-container > svg') as any;\n\n            const spookySpinner = videoPlayer.current?.querySelector('#spookySpinner svg') as any;\n            const theoSpinner = videoPlayer.current?.querySelector('.theo-loading-spinner-rotator') as any;\n\n            videoPlayer.current?.querySelector('.theo-big-play-button-svg-container')\n                ?.replaceChild(bigPlay, theoPlay);\n\n                // videoPlayer.current?.querySelector('.theo-secondary-color.vjs-loading-spinner ')\n                // ?.replaceChild(spookySpinner, theoSpinner);\n\n            videoPlayer.current?.querySelector('.theo-cast-button.theo-chromecast-button.theo-controlbar-button.vjs-control.vjs-button')\n                ?.remove();\n            videoPlayer.current?.querySelector('.theo-cast-button.theo-airplay-button.theo-controlbar-button.vjs-control.vjs-button')\n                ?.remove();\n            \n        }\n    }, [player])\n    useEffect(() => {\n        if (token && stream && (player !== null && player)) {\n            let source: { src: string | undefined, type: string } = {\n                src: undefined,\n                type: 'application/x-mpegurl' // sets type to HLS\n            }\n            let param = `?timestamp=${token.timestamp}&token=${token.token}&clientId=${token.client_id}`;\n            if (stream.vods.data.length > 0) {\n                source.src = `${stream.vods.data[0].data.m3u8}${param}`;\n            } else if (stream.live !== null) {\n                source.src = `${stream.live.m3u8}${param}`;\n            }\n\n            player.source = {\n                sources: [source]\n            };\n            \n            if (props.position ?? 0 !== 0) {\n                player.currentTime = props.position;\n            }\n            player.play();\n        }\n    }, [stream, token])\n\n    const hide = {\n        display: 'none'\n    }\n\n    return (<div\n        ref={videoPlayer}\n        className={'spooky-player theoplayer-container video-js theoplayer-skin vjs-16-9 THEOplayer'}\n    >\n        <span id=\"bigPlay\" style={hide}>\n            <svg className={'big-play'} role=\"presentation\">\n                <use xlinkHref=\"#icon-play\"></use>\n            </svg>\n        </span>\n\n        <span id=\"spookySpinner\" style={hide}>\n            \n            <svg className={'spooky-spinner'} role=\"presentation\">\n                <use xlinkHref=\"#icon-spinner\"></use>\n            </svg>\n        </span>\n\n    </div>)\n}\n\nexport default VideoPlayerDefault;"]},"metadata":{},"sourceType":"module"}