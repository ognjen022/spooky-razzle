{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport debounce from 'debounce-promise';\nimport { Link } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid';\nimport SeoHead from '../../components/SeoHead/SeoHead';\nimport styles from './Browse.module.scss';\nimport { tagsFilterSelectedEvent, tagsFilterRemovedEvent, tagsFilterSearchTermSelectedEvent, tagsFilterSearchTermRemovedEvent } from '../../services/content/tags/events';\nimport AccordionFilter from '../../components/AccordionFilter/AccordionFilter';\n\nconst Browse = () => {\n  const dispatch = useDispatch();\n  const hasFilter = useSelector(state => state.content.tags.filters.length > 0);\n  const filters = useSelector(state => state.content.tags.filters);\n  const browseFiltered = useSelector(state => state.content.tags.browseFiltered);\n  const {\n    0: searchValue,\n    1: setSearchValue\n  } = useState('');\n  const {\n    0: resultsFor,\n    1: setResultsFor\n  } = useState('');\n\n  const handleFormSubmit = e => {\n    // ('handleFormSubmit searchValue.toLowerCase()', searchValue.toLowerCase())\n    e.preventDefault();\n    dispatch(tagsFilterSearchTermSelectedEvent(searchValue.toLowerCase()));\n  };\n\n  const handleFilterSelect = item => {\n    dispatch(tagsFilterSelectedEvent(item.tagId));\n  };\n\n  const handleFilterRemove = () => {\n    // Clear redux accordion filters\n    dispatch(tagsFilterRemovedEvent()); // Clear redux search term store\n\n    dispatch(tagsFilterSearchTermRemovedEvent()); // Clear search\n\n    setSearchValue('');\n    setResultsFor('');\n  };\n\n  const dispatchSearch = searchTerm => {\n    const search = searchTerm.trim().toLocaleLowerCase();\n    dispatch(tagsFilterSearchTermSelectedEvent(search));\n    setResultsFor(search);\n  };\n\n  const debounceDispatchSearch = useCallback(debounce(dispatchSearch, 200), []);\n\n  const onSearchTermChange = event => {\n    const {\n      value\n    } = event.currentTarget;\n\n    if (value === '' || value === undefined) {\n      handleFilterRemove();\n    } else {\n      setSearchValue(value);\n      debounceDispatchSearch(value);\n      if (value === '') dispatchSearch(value);\n    }\n  };\n\n  let userId = useSelector(state => {\n    var _state$userSecurity$p;\n\n    return ((_state$userSecurity$p = state.userSecurity.profile) === null || _state$userSecurity$p === void 0 ? void 0 : _state$userSecurity$p.id) || undefined;\n  });\n  /*TagManager.dataLayer({\n    dataLayer: {\n      userId,\n      userProject: 'Sideline Live',\n      page: `/browse`\n    },\n    dataLayerName: 'PageDataLayer'\n  })*/\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  return __jsx(\"section\", null, __jsx(SeoHead, {\n    metaDescription: 'Browse',\n    ogDescription: 'Browse',\n    ogImage: '',\n    ogTitle: 'Browse',\n    title: 'Browse'\n  }), __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: styles.browse\n  }, __jsx(\"aside\", {\n    className: styles['browse__aside']\n  }, __jsx(\"h1\", {\n    className: styles['browse__title']\n  }, \"Search & filter\"), __jsx(\"div\", {\n    className: styles['browse__filters-container']\n  }, __jsx(\"div\", {\n    className: styles['browse__filters-input']\n  }, __jsx(\"form\", {\n    onSubmit: handleFormSubmit\n  }, __jsx(\"input\", {\n    value: searchValue,\n    type: \"search\",\n    placeholder: \"Search...\",\n    className: styles['browse__filters-search'],\n    onChange: onSearchTermChange\n  }), __jsx(\"button\", {\n    type: \"submit\",\n    className: styles['browse__filters-search-button']\n  }, __jsx(\"svg\", {\n    className: \"icon\",\n    role: \"presentation\"\n  }, __jsx(\"use\", {\n    xlinkHref: \"#icon-search\"\n  })), __jsx(\"span\", {\n    className: \"screen-reader-text\"\n  }, \"Search\")))), __jsx(\"div\", {\n    className: styles['browse__filters-heading']\n  }, __jsx(\"span\", null, \"Filter by\"), __jsx(\"button\", {\n    className: hasFilter ? styles['browse__clear-bold'] : styles['browse__clear'],\n    onClick: handleFilterRemove\n  }, \"Clear\")), browseFiltered.map(browseOption => __jsx(AccordionFilter, {\n    key: uuidv4(),\n    option: browseOption,\n    filters: filters,\n    onSelect: handleFilterSelect\n  })))), __jsx(\"div\", {\n    className: styles['browse__content']\n  }, __jsx(\"h1\", {\n    className: styles['browse__title']\n  }, \"Results\", resultsFor.length > 0 && __jsx(\"span\", {\n    className: styles['browse__results-for']\n  }, \" (\", resultsFor, \")\")), browseFiltered.map(browseOption => __jsx(\"div\", {\n    key: uuidv4(),\n    className: styles['browse__category-results']\n  }, __jsx(\"h2\", null, browseOption.name), __jsx(\"ul\", {\n    className: styles['browse__list-group']\n  }, __jsx(BrowseList, {\n    results: browseOption.items\n  }))))))));\n};\n\nexport default Browse;\n\nconst BrowseList = props => {\n  const {\n    results\n  } = props;\n  return __jsx(React.Fragment, null, results.map(result => __jsx(\"li\", {\n    key: uuidv4()\n  }, __jsx(Link, {\n    to: result.path || '/browse'\n  }, result.name))));\n};","map":{"version":3,"sources":["/Users/ognjen/Desktop/spooky-live-ssr/ui/src/scenes/Browse/Browse.tsx"],"names":["React","useState","useCallback","useEffect","useDispatch","useSelector","debounce","Link","v4","uuidv4","SeoHead","styles","tagsFilterSelectedEvent","tagsFilterRemovedEvent","tagsFilterSearchTermSelectedEvent","tagsFilterSearchTermRemovedEvent","AccordionFilter","Browse","dispatch","hasFilter","state","content","tags","filters","length","browseFiltered","searchValue","setSearchValue","resultsFor","setResultsFor","handleFormSubmit","e","preventDefault","toLowerCase","handleFilterSelect","item","tagId","handleFilterRemove","dispatchSearch","searchTerm","search","trim","toLocaleLowerCase","debounceDispatchSearch","onSearchTermChange","event","value","currentTarget","undefined","userId","userSecurity","profile","id","window","scrollTo","browse","map","browseOption","name","items","BrowseList","props","results","result","path"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport debounce from 'debounce-promise';\nimport { Link } from 'react-router-dom'\nimport _ from 'lodash'\nimport { v4 as uuidv4 } from 'uuid'\nimport TagManager from 'react-gtm-module'\n\nimport { RootState } from '../../services/RootState'\nimport { IContentState } from '../../services/content/IContentState'\nimport { ITagsState, BrowseOption, BrowseResult } from '../../services/content/tags/models'\nimport { ITag } from '../../services/content/tags/models'\nimport SeoHead from '../../components/SeoHead/SeoHead'\n\nimport styles from './Browse.module.scss'\n\nimport { tagsFilterSelectedEvent, tagsFilterRemovedEvent, tagsFilterSearchTermSelectedEvent, tagsFilterSearchTermRemovedEvent } from '../../services/content/tags/events'\n\nimport AccordionFilter from '../../components/AccordionFilter/AccordionFilter'\n\nconst Browse = () => {\n  const dispatch = useDispatch()\n  const hasFilter = useSelector<RootState, boolean>((state: RootState) => state.content.tags.filters.length > 0)\n  const filters = useSelector<RootState, string[]>((state: RootState) => state.content.tags.filters)\n  const browseFiltered: BrowseOption[] = useSelector<RootState, BrowseOption[]>((state: RootState) => state.content.tags.browseFiltered)\n\n  const [searchValue, setSearchValue] = useState<string>('');\n  const [resultsFor, setResultsFor] = useState<string>('');\n\n  const handleFormSubmit = (e) => {\n    // ('handleFormSubmit searchValue.toLowerCase()', searchValue.toLowerCase())\n    e.preventDefault();\n    dispatch(tagsFilterSearchTermSelectedEvent(searchValue.toLowerCase()));\n  }\n\n  const handleFilterSelect = (item: BrowseResult) => {\n    dispatch(tagsFilterSelectedEvent(item.tagId))\n  }\n\n  const handleFilterRemove = () => {\n    // Clear redux accordion filters\n    dispatch(tagsFilterRemovedEvent())\n    // Clear redux search term store\n    dispatch(tagsFilterSearchTermRemovedEvent())\n    // Clear search\n    setSearchValue('')\n    setResultsFor('')\n  }\n\n  const dispatchSearch = (searchTerm: string) => {\n    const search = searchTerm.trim().toLocaleLowerCase();\n    dispatch(tagsFilterSearchTermSelectedEvent(search));\n    setResultsFor(search)\n  };\n\n  const debounceDispatchSearch = useCallback(debounce(dispatchSearch, 200), []);\n\n  const onSearchTermChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.currentTarget\n\n    if (value === '' || value === undefined) {\n      handleFilterRemove()\n    } else {\n      setSearchValue(value)\n      debounceDispatchSearch(value)\n      if (value === '') dispatchSearch(value)\n    }\n  }\n\n  let userId = useSelector<RootState, string | undefined>((state) => state.userSecurity.profile?.id || undefined)\n\n  /*TagManager.dataLayer({\n    dataLayer: {\n      userId,\n      userProject: 'Sideline Live',\n      page: `/browse`\n    },\n    dataLayerName: 'PageDataLayer'\n  })*/\n\n  useEffect(() => {\n    window.scrollTo(0, 0)\n  }, [])\n\n  return (\n    <section>\n      <SeoHead metaDescription={'Browse'} ogDescription={'Browse'} ogImage={''} ogTitle={'Browse'} title={'Browse'} />\n      <div className=\"container\">\n        <div className={styles.browse}>\n          <aside className={styles['browse__aside']}>\n            <h1 className={styles['browse__title']}>Search & filter</h1>\n            <div className={styles['browse__filters-container']}>\n\n              <div className={styles['browse__filters-input']}>\n                <form onSubmit={handleFormSubmit}>\n                  <input\n                    value={searchValue}\n                    type=\"search\"\n                    placeholder=\"Search...\"\n                    className={styles['browse__filters-search']}\n                    onChange={onSearchTermChange}\n                  />\n                  <button type=\"submit\" className={styles['browse__filters-search-button']}>\n                    <svg className=\"icon\" role=\"presentation\">\n                      <use xlinkHref=\"#icon-search\"></use>\n                    </svg>\n                    <span className=\"screen-reader-text\">Search</span>\n                  </button>\n                </form>\n              </div>\n              <div className={styles['browse__filters-heading']}>\n                <span>Filter by</span>\n                <button className={hasFilter ? styles['browse__clear-bold'] : styles['browse__clear']} onClick={handleFilterRemove}>Clear</button>\n              </div>\n\n              {browseFiltered.map(browseOption => (\n                <AccordionFilter key={uuidv4()} option={browseOption} filters={filters} onSelect={handleFilterSelect} />\n              ))}\n\n            </div>\n          </aside>\n          <div className={styles['browse__content']}>\n            <h1 className={styles['browse__title']}>\n              Results\n              {resultsFor.length > 0 && <span className={styles['browse__results-for']}> ({resultsFor})</span>}\n            </h1>\n\n            {browseFiltered.map(browseOption => (\n              <div key={uuidv4()} className={styles['browse__category-results']}>\n                <h2>\n                  {browseOption.name}\n                  {/*tags.filters?.length > 0 && tag?.children && selectedChild(tag?.children, filters) && selectedChild(tag?.children, filters)?.children && ' / '}\n                  {tags.filters?.length > 0 && tag?.children && selectedChild(tag?.children, filters) && selectedChild(tag?.children, filters)?.children && <Link to={selectedChild(tag?.children, filters)?.path || '/browse'}>{selectedChild(tag?.children, filters)?.name}</Link>*/}\n                </h2>\n                <ul className={styles['browse__list-group']}>\n                  <BrowseList results={browseOption.items} />\n                </ul>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </section>\n  )\n}\n\nexport default Browse\n\ninterface IBrowseListProps {\n  results: BrowseResult[]\n  // filters: string[] | undefined\n}\n\n\nconst BrowseList: React.FC<IBrowseListProps> = (props) => {\n  const { results } = props\n\n  return (\n    <>\n      {results.map(result => (\n        <li key={uuidv4()}><Link to={result.path || '/browse'}>{result.name}</Link></li>\n      ))}\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}