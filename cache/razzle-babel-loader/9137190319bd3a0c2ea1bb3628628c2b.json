{"ast":null,"code":"import { from, of } from 'rxjs';\nimport { exhaustMap, filter, catchError } from 'rxjs/operators';\nimport { isActionOf } from 'typesafe-actions';\nimport { paymentDetailsRequestedEvent, paymentDetailsReceivedEvent, paymentDetailsErroredEvent } from '../events';\nimport { getPaymentsPaymentDetails } from '../api/getPaymentsPaymentDetails';\nimport { profileRequestedEvent } from '../../../userSecurity/profile/events';\nimport Notifications from 'react-notification-system-redux';\n\nconst getSuccessNotification = () => {\n  return Notifications.success({\n    title: 'Saved',\n    message: 'Your payment details have been updated',\n    position: 'tc',\n    autoDismiss: 10,\n    action: {\n      label: 'Close',\n      callback: () => console.log('Notification closed')\n    }\n  });\n};\n\nconst getErrorNotification = () => {\n  return Notifications.error({\n    title: 'Error',\n    message: 'Your payment details have not been updated',\n    position: 'tc',\n    autoDismiss: 10,\n    action: {\n      label: 'Close',\n      callback: () => console.log('Notification closed')\n    }\n  });\n};\n\nconst paymentDetailsRequestedEpic = (action$, store) => action$.pipe(filter(isActionOf(paymentDetailsRequestedEvent)), exhaustMap(event => from(getPaymentsPaymentDetails({\n  name: event.payload.name,\n  card: event.payload.card,\n  ccv: event.payload.ccv,\n  expiryMonth: event.payload.expiryMonth,\n  expiryYear: event.payload.expiryYear,\n  address1: event.payload.address1,\n  address2: event.payload.address2,\n  city: event.payload.city,\n  postCode: event.payload.postCode,\n  country: event.payload.country\n})).pipe(exhaustMap(apiResponse => {\n  console.log('[paymentDetailsRequestedEpic apiResponse]', apiResponse);\n  return apiResponse.statusCode ? of(paymentDetailsReceivedEvent(apiResponse.data), profileRequestedEvent(), getSuccessNotification()) : of(paymentDetailsErroredEvent(apiResponse.data), getErrorNotification());\n}), catchError(() => of(paymentDetailsErroredEvent({\n  id: undefined,\n  error: 'Network error',\n  errorDescription: 'Check your internet connection',\n  token: undefined\n}))))));\n\nexport default [paymentDetailsRequestedEpic];","map":{"version":3,"sources":["/Users/ognjen/Desktop/spooky.live-ssr/src/services/payments/paymentDetails/epics/paymentDetailsRequestedEpic.ts"],"names":["from","of","exhaustMap","filter","catchError","isActionOf","paymentDetailsRequestedEvent","paymentDetailsReceivedEvent","paymentDetailsErroredEvent","getPaymentsPaymentDetails","profileRequestedEvent","Notifications","getSuccessNotification","success","title","message","position","autoDismiss","action","label","callback","console","log","getErrorNotification","error","paymentDetailsRequestedEpic","action$","store","pipe","event","name","payload","card","ccv","expiryMonth","expiryYear","address1","address2","city","postCode","country","apiResponse","statusCode","data","id","undefined","errorDescription","token"],"mappings":"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","sourcesContent":["import { Epic } from 'redux-observable'\nimport { from, of } from 'rxjs'\nimport { exhaustMap, filter, catchError } from 'rxjs/operators'\nimport { isActionOf } from 'typesafe-actions'\nimport { paymentDetailsRequestedEvent, paymentDetailsReceivedEvent, paymentDetailsErroredEvent } from '../events'\nimport { RootState } from '../../../RootState'\nimport { getPaymentsPaymentDetails } from '../api/getPaymentsPaymentDetails'\nimport { profileRequestedEvent } from '../../../userSecurity/profile/events'\nimport Notifications from 'react-notification-system-redux'\n\n\nconst getSuccessNotification = () => {\n  return Notifications.success(\n    {\n      title: 'Saved',\n      message: 'Your payment details have been updated',\n      position: 'tc',\n      autoDismiss: 10,\n      action: {\n        label: 'Close',\n        callback: () => console.log('Notification closed')\n      }\n    }\n  )\n}\n\nconst getErrorNotification = () => {\n  return Notifications.error(\n    {\n      title: 'Error',\n      message: 'Your payment details have not been updated',\n      position: 'tc',\n      autoDismiss: 10,\n      action: {\n        label: 'Close',\n        callback: () => console.log('Notification closed')\n      }\n    }\n  )\n}\n\nconst paymentDetailsRequestedEpic: Epic<any, any, RootState> = (action$, store) =>\n  action$.pipe(\n    filter(isActionOf(paymentDetailsRequestedEvent)),\n    exhaustMap(event =>\n      from(getPaymentsPaymentDetails({\n        name: event.payload.name,\n        card: event.payload.card,\n        ccv: event.payload.ccv,\n        expiryMonth: event.payload.expiryMonth,\n        expiryYear: event.payload.expiryYear,\n        address1: event.payload.address1,\n        address2: event.payload.address2,\n        city: event.payload.city,\n        postCode: event.payload.postCode,\n        country: event.payload.country,\n      })).pipe(\n        exhaustMap(apiResponse => {\n          console.log('[paymentDetailsRequestedEpic apiResponse]', apiResponse)\n          return apiResponse.statusCode\n            ? of(\n              paymentDetailsReceivedEvent(apiResponse.data),\n              profileRequestedEvent(),\n              getSuccessNotification()\n            ) : of(\n              paymentDetailsErroredEvent(apiResponse.data),\n              getErrorNotification()\n            )\n        }),\n        catchError(() => of(paymentDetailsErroredEvent({\n          id: undefined,\n          error: 'Network error',\n          errorDescription: 'Check your internet connection',\n          token: undefined\n        })))\n      )\n    )\n  )\n\nexport default [paymentDetailsRequestedEpic]\n"]},"metadata":{},"sourceType":"module"}