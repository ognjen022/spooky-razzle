{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { memo, useEffect, useState } from 'react';\nimport styles from './Header.module.scss';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport moment from 'moment';\nimport LiveLogo from '../../svg/images/live-logo.svg';\nimport { selectIsLoggedIn, selectIsTokenValid } from '../../services/userSecurity/token/selectors';\nimport { selectInitials } from '../../services/userSecurity/profile/selectors';\nimport { tokenRemovedEvent, tokenRefreshTokenRequestedEvent } from '../../services/userSecurity/token/events';\nimport { tagsRequestedEvent } from '../../services/content/tags/events';\nimport { v4 as uuidv4 } from 'uuid';\nimport Button from '../Button/Button';\nimport { accountToggleLoginEvent, accountToggleSignupEvent } from '../../services/userSecurity/accountDetails/events';\nimport { showPurchaseModalToggledEvent } from '../../services/payments/purchase/events';\n\nconst Header = props => {\n  let currentPathName = useSelector(state => state.router.location.pathname);\n  let isLoggedIn = useSelector(state => selectIsLoggedIn(state.userSecurity.token));\n  let isTokenValid = useSelector(state => selectIsTokenValid(state.userSecurity.token));\n  let initials = useSelector(state => selectInitials(state.userSecurity.profile));\n  let profile = useSelector(state => state.userSecurity.profile); // let hasWathchItAll = useSelector<RootState, boolean>(state => selectHasWatchItAll(state.payments.subscriptions))\n\n  const streams = useSelector(state => state.content.tags.streams);\n  const liveStreams = streams === null || streams === void 0 ? void 0 : streams.some(stream => {\n    let now = moment();\n    let streamStart = moment(stream.startTime);\n    let streamEnd = moment(stream.startTime).add(stream.duration, 'm');\n    let isActive = now.isBetween(streamStart, streamEnd);\n    return isActive;\n  });\n  const futureStreams = streams === null || streams === void 0 ? void 0 : streams.some(st => moment().isSameOrBefore(st.startTime));\n  const {\n    hasWatchItAll\n  } = props;\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(tagsRequestedEvent());\n  }, [dispatch]);\n\n  if (profile.id !== null) {\n    if (!isTokenValid) {\n      dispatch(tokenRefreshTokenRequestedEvent()); // invalid token. refresh the token\n    } else {\n      dispatch({\n        type: 'TOKEN_PERSIST'\n      });\n    }\n  }\n\n  const {\n    0: showMobileMenu,\n    1: toggleMobileMenu\n  } = useState(false);\n\n  const toggleLogin = () => {\n    dispatch(accountToggleLoginEvent());\n  };\n\n  const togglePremium = () => {\n    dispatch(showPurchaseModalToggledEvent(undefined, undefined, undefined));\n  };\n\n  const toggleSignup = () => {\n    dispatch(accountToggleSignupEvent());\n  };\n\n  const handleMobileMenuClick = () => {\n    toggleMobileMenu(!showMobileMenu);\n  };\n\n  const handleMobileLogoClick = () => {\n    toggleMobileMenu(!showMobileMenu);\n  };\n\n  const signOut = () => {\n    window.localStorage.clear();\n    dispatch(tokenRemovedEvent());\n  };\n\n  const isOpenClass = showMobileMenu ? styles['is-active'] : '';\n  const navConfig = [{\n    label: 'Home',\n    link: '/',\n    visible: true\n  }, {\n    label: 'Browse',\n    link: '/browse',\n    visible: true\n  }, {\n    label: 'Upcoming',\n    link: '/upcoming',\n    visible: futureStreams\n  }, {\n    label: 'Latest',\n    link: '/latest',\n    visible: true\n  }, {\n    label: 'My Streams',\n    link: '/my-streams',\n    visible: isLoggedIn\n  }, {\n    label: 'News',\n    link: '/news',\n    visible: false\n  }];\n\n  const isSelected = path => path === currentPathName;\n\n  return __jsx(\"header\", {\n    className: styles.header,\n    id: \"top\"\n  }, __jsx(\"div\", {\n    className: `container ${styles.container}`\n  }, !isOpenClass && __jsx(Link, {\n    to: '/',\n    className: styles.header__logo\n  }, __jsx(\"img\", {\n    src: LiveLogo,\n    alt: \"Live\"\n  })), isOpenClass && __jsx(Link, {\n    to: '',\n    onClick: () => handleMobileLogoClick(),\n    className: styles.header__logo\n  }, __jsx(\"img\", {\n    src: LiveLogo,\n    alt: \"Live\"\n  })), __jsx(\"nav\", {\n    className: `${styles['header-nav']} ${isOpenClass}`,\n    onClick: () => handleMobileMenuClick()\n  }, __jsx(\"ul\", {\n    className: styles['header-nav__list']\n  }, !isLoggedIn && __jsx(React.Fragment, null, __jsx(\"li\", {\n    className: `${styles['header-nav__list-item']} ${styles['header-nav--mobile-show']}`\n  }, __jsx(Link, {\n    to: \"#\",\n    onClick: () => toggleLogin(),\n    className: `${styles['header-nav__link']}`\n  }, \"Log in\")), __jsx(\"li\", {\n    className: `${styles['header-nav__list-item']} ${styles['header-nav--mobile-show']}`\n  }, __jsx(Link, {\n    to: \"#\",\n    className: `${styles['header-nav__link']}`\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: \"success\",\n    label: \"Sign up\",\n    onClick: toggleSignup\n  })))), isSelected('/live-now') ? __jsx(\"li\", {\n    className: styles['header-nav__list-item'],\n    key: uuidv4()\n  }, __jsx(\"span\", {\n    className: `${styles['is-selected']} ${styles['header-nav--mobile-hide']}`\n  }, \"Live now\"), __jsx(Link, {\n    to: \"/live-now\",\n    className: `${styles['header-nav__link']} ${styles['header-nav__live-now-button']} ${styles['header-nav--mobile-show']}`\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: liveStreams ? \"success\" : \"ghost\",\n    label: \"live now\",\n    disabled: !liveStreams\n  }))) : __jsx(React.Fragment, null, liveStreams && __jsx(\"li\", {\n    className: styles['header-nav__list-item'],\n    key: uuidv4()\n  }, __jsx(Link, {\n    to: \"/live-now\",\n    className: `${styles['header-nav__link']} ${styles['header-nav__live-now-button']}`\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: liveStreams ? \"success\" : \"ghost\",\n    label: \"live now\",\n    disabled: !liveStreams\n  })))), navConfig.map(({\n    label,\n    link,\n    visible\n  }) => visible && __jsx(\"li\", {\n    className: styles['header-nav__list-item'],\n    key: uuidv4()\n  }, __jsx(Link, {\n    to: link,\n    className: styles['header-nav__link']\n  }, __jsx(\"span\", {\n    className: isSelected(link) ? styles['is-selected'] : ''\n  }, label))))), __jsx(\"ul\", {\n    className: styles['header-nav__list']\n  }, !isLoggedIn && __jsx(React.Fragment, null, __jsx(\"li\", {\n    className: `${styles['header-nav__list-item']} ${styles['header-nav--mobile-hide']}`\n  }, __jsx(Link, {\n    to: \"#\",\n    onClick: () => toggleLogin(),\n    className: `${styles['header-nav__link']} ${styles['header-nav__login-button']}`\n  }, \"Log in\")), __jsx(\"li\", {\n    className: `${styles['header-nav__list-item']} ${styles['header-nav--mobile-hide']}`\n  }, __jsx(Link, {\n    to: \"#\",\n    className: `${styles['header-nav__link']} ${styles['header-nav__login-button']}`\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: \"success\",\n    label: \"Sign up\",\n    onClick: toggleSignup\n  })))), isLoggedIn && __jsx(React.Fragment, null, !hasWatchItAll && __jsx(\"li\", {\n    className: `${styles['header-nav__list-item']} ${styles['header-nav__list-item--account']}`\n  }, __jsx(Link, {\n    to: '#',\n    onClick: togglePremium,\n    className: ` ${styles['header-nav__link']} ${styles['header-nav--green']} ${styles['header-nav__link--account']}`\n  }, \"Go Premium\")), __jsx(\"li\", {\n    className: `${styles['header-nav__list-item']} ${styles['header-nav__list-item--account']}`\n  }, isLoggedIn && initials && __jsx(Link, {\n    to: '/account',\n    className: `show-large ${styles['header-nav__link']} ${styles['header-nav__link--account']}`\n  }, \"Account\"), isLoggedIn && __jsx(Link, {\n    to: \"\",\n    onClick: signOut,\n    className: `${styles['header-nav__link']} ${styles['header-nav__link--account']}`\n  }, \"Sign out\"), isLoggedIn && initials && __jsx(Link, {\n    to: '/account',\n    className: `hide-large ${styles['profile-badge']}`\n  }, __jsx(\"span\", {\n    className: styles['profile-badge__initials']\n  }, initials)))))), __jsx(\"button\", {\n    className: `${styles['menu-button']} ${isOpenClass}`,\n    onClick: () => handleMobileMenuClick()\n  }, __jsx(\"span\", {\n    className: \"screen-reader-text\"\n  }, \"Menu\"), __jsx(\"span\", {\n    className: styles['menu-button__burger-icon']\n  }))));\n};\n\nexport default /*#__PURE__*/memo(Header);","map":{"version":3,"sources":["/Users/ognjen/Desktop/spooky.live-ssr/src/components/Header/Header.tsx"],"names":["React","memo","useEffect","useState","styles","useDispatch","useSelector","Link","moment","LiveLogo","selectIsLoggedIn","selectIsTokenValid","selectInitials","tokenRemovedEvent","tokenRefreshTokenRequestedEvent","tagsRequestedEvent","v4","uuidv4","Button","accountToggleLoginEvent","accountToggleSignupEvent","showPurchaseModalToggledEvent","Header","props","currentPathName","state","router","location","pathname","isLoggedIn","userSecurity","token","isTokenValid","initials","profile","streams","content","tags","liveStreams","some","stream","now","streamStart","startTime","streamEnd","add","duration","isActive","isBetween","futureStreams","st","isSameOrBefore","hasWatchItAll","dispatch","id","type","showMobileMenu","toggleMobileMenu","toggleLogin","togglePremium","undefined","toggleSignup","handleMobileMenuClick","handleMobileLogoClick","signOut","window","localStorage","clear","isOpenClass","navConfig","label","link","visible","isSelected","path","header","container","header__logo","map"],"mappings":"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","sourcesContent":["import React, { memo, useEffect, useState } from 'react'\nimport styles from './Header.module.scss'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport moment from 'moment'\nimport LiveLogo from '../../svg/images/live-logo.svg'\nimport { RootState } from '../../services/RootState'\nimport { selectIsLoggedIn, selectIsTokenValid } from '../../services/userSecurity/token/selectors'\nimport { selectInitials, selectIntercomInfo } from '../../services/userSecurity/profile/selectors'\nimport { tokenRemovedEvent, tokenRefreshTokenRequestedEvent } from '../../services/userSecurity/token/events'\nimport { configRequestedEvent } from '../../services/config/events'\nimport { tagsRequestedEvent } from '../../services/content/tags/events'\nimport { selectHasWatchItAll } from '../../services/payments/subscriptions/selectors'\nimport { v4 as uuidv4 } from 'uuid'\nimport Button from '../Button/Button'\nimport { IStream } from '../../services/content/tags/models'\nimport { profileReceivedEvent } from '../../services/userSecurity/profile/events'\nimport { ProfileState } from '../../services/userSecurity/profile/models'\nimport { accountToggleLoginEvent, accountToggleSignupEvent } from '../../services/userSecurity/accountDetails/events'\nimport { showPurchaseModalToggledEvent } from '../../services/payments/purchase/events'\n\nexport interface IHeaderProps {\n  hasWatchItAll: boolean\n}\n\n\nconst Header: React.FC<IHeaderProps> = (props) => {\n\n  let currentPathName = useSelector<RootState, string>((state) => state.router.location.pathname)\n  let isLoggedIn = useSelector<RootState, boolean>((state) => selectIsLoggedIn(state.userSecurity.token))\n  let isTokenValid = useSelector<RootState, boolean>((state) => selectIsTokenValid(state.userSecurity.token));\n  let initials = useSelector<RootState, string>((state) => selectInitials(state.userSecurity.profile))\n  let profile = useSelector<RootState, ProfileState>((state => state.userSecurity.profile));\n\n  // let hasWathchItAll = useSelector<RootState, boolean>(state => selectHasWatchItAll(state.payments.subscriptions))\n  const streams = useSelector<RootState, IStream[] | undefined>(state => state.content.tags.streams)\n\n  const liveStreams = streams?.some(stream => {\n    let now = moment()\n    let streamStart = moment(stream.startTime)\n    let streamEnd = moment(stream.startTime).add(stream.duration, 'm')\n    let isActive = now.isBetween(streamStart, streamEnd)\n\n    return isActive\n  })\n  const futureStreams = streams?.some(st => moment().isSameOrBefore(st.startTime));\n\n  const { hasWatchItAll } = props\n\n  const dispatch = useDispatch()\n\n  useEffect(() => {\n    dispatch(tagsRequestedEvent());\n  }, [dispatch]);\n\nif (profile.id !== null) {\n  if (!isTokenValid) {\n    dispatch(tokenRefreshTokenRequestedEvent()) // invalid token. refresh the token\n  } else {\n    dispatch({\n      type: 'TOKEN_PERSIST'\n    })\n  }\n}\n  const [showMobileMenu, toggleMobileMenu] = useState(false);\n\n  const toggleLogin = () => {\n    dispatch(accountToggleLoginEvent());\n  }\n  const togglePremium = () => {\n    dispatch(showPurchaseModalToggledEvent(undefined, undefined, undefined));\n  }\n  const toggleSignup = () => {\n    dispatch(accountToggleSignupEvent());\n  }\n  const handleMobileMenuClick = () => {\n    toggleMobileMenu(!showMobileMenu)\n  }\n  const handleMobileLogoClick = () => {\n    toggleMobileMenu(!showMobileMenu);\n\n  }\n  const signOut = () => {\n    window.localStorage.clear();\n    dispatch(tokenRemovedEvent());\n  }\n\n  const isOpenClass = showMobileMenu ? styles['is-active'] : '';\n\n  const navConfig = [\n    {\n      label: 'Home',\n      link: '/',\n      visible: true,\n    }, {\n      label: 'Browse',\n      link: '/browse',\n      visible: true,\n    }, {\n      label: 'Upcoming',\n      link: '/upcoming',\n      visible: futureStreams,\n    }, {\n      label: 'Latest',\n      link: '/latest',\n      visible: true,\n    }, {\n      label: 'My Streams',\n      link: '/my-streams',\n      visible: isLoggedIn,\n    }, {\n      label: 'News',\n      link: '/news',\n      visible: false,\n    },\n  ]\n\n  const isSelected = (path) => path === currentPathName\n\n\n  return (\n    <header className={styles.header} id=\"top\">\n      <div className={`container ${styles.container}`}>\n        {!isOpenClass &&\n          <Link to={'/'} className={styles.header__logo}>\n\n            <img src={LiveLogo} alt=\"Live\" />\n\n          </Link>}\n        {isOpenClass &&\n          <Link to={''} onClick={() => handleMobileLogoClick()} className={styles.header__logo}>\n\n            <img src={LiveLogo} alt=\"Live\" />\n\n          </Link>}\n        <nav className={`${styles['header-nav']} ${isOpenClass}`} onClick={() => handleMobileMenuClick()}>\n          <ul className={styles['header-nav__list']}>\n\n            {!isLoggedIn &&\n              <>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-show']}`}>\n                  <Link to='#' onClick={() => toggleLogin()} \n                    className={`${styles['header-nav__link']}`}>\n                      Log in\n                    </Link>\n                </li>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-show']}`}>\n                <Link\n                    to='#'\n                    className={`${styles['header-nav__link']}`}\n                  >\n                    <Button\n                      variant=\"secondary\"\n                      color=\"success\"\n                      label=\"Sign up\"\n                      onClick={toggleSignup}\n                    />\n                  </Link>\n                </li>\n              </>\n            }\n\n            {isSelected('/live-now') ? (\n              <li className={styles['header-nav__list-item']} key={uuidv4()}>\n                <span className={`${styles['is-selected']} ${styles['header-nav--mobile-hide']}`}>\n                  Live now\n                </span>\n\n                <Link to=\"/live-now\" className={`${styles['header-nav__link']} ${styles['header-nav__live-now-button']} ${styles['header-nav--mobile-show']}`}>\n                  <Button\n                    variant=\"secondary\"\n                    color={liveStreams ? \"success\" : \"ghost\"}\n                    label=\"live now\"\n                    disabled={!liveStreams}\n                  />\n                </Link>\n              </li>\n            ) :\n              <>\n                {liveStreams &&\n                  <li className={styles['header-nav__list-item']} key={uuidv4()}>\n                    <Link to=\"/live-now\" className={`${styles['header-nav__link']} ${styles['header-nav__live-now-button']}`}>\n                      <Button\n                        variant=\"secondary\"\n                        color={liveStreams ? \"success\" : \"ghost\"}\n                        label=\"live now\"\n                        disabled={!liveStreams}\n                      />\n                    </Link>\n                  </li>\n                }\n              </>\n            }\n            {navConfig.map(({ label, link, visible }) => visible &&\n              <li className={styles['header-nav__list-item']} key={uuidv4()}>\n                <Link to={link} className={styles['header-nav__link']}>\n                  <span className={isSelected(link) ? styles['is-selected'] : ''}>\n                    {label}\n                  </span>\n                </Link>\n              </li>\n            )}\n\n          </ul>\n\n          <ul className={styles['header-nav__list']}>\n\n            {!isLoggedIn &&\n              <>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-hide']}`}>\n                  <Link to='#' onClick={() => toggleLogin()} \n                    className={`${styles['header-nav__link']} ${styles['header-nav__login-button']}`}>\n                      Log in\n                    </Link>\n                </li>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-hide']}`}>\n                  <Link\n                    to='#'\n                    className={`${styles['header-nav__link']} ${styles['header-nav__login-button']}`}\n                  >\n                    <Button\n                      variant=\"secondary\"\n                      color=\"success\"\n                      label=\"Sign up\"\n                      onClick={toggleSignup}\n                    />\n                  </Link>\n                </li>\n              </>\n            }\n\n            {isLoggedIn &&\n            \n            <>\n              { !hasWatchItAll &&\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav__list-item--account']}`}>\n                  <Link to={'#'} onClick={togglePremium} className={` ${styles['header-nav__link']} ${styles['header-nav--green']} ${styles['header-nav__link--account']}`}>\n                    Go Premium\n                  </Link>\n                </li>\n              }\n              <li className={`${styles['header-nav__list-item']} ${styles['header-nav__list-item--account']}`}>\n              {\n                isLoggedIn && initials &&\n                  <Link to={'/account'} className={`show-large ${styles['header-nav__link']} ${styles['header-nav__link--account']}`}>\n                    Account\n                  </Link>\n              }\n              {\n                isLoggedIn &&\n                  <Link to='' onClick={signOut} className={`${styles['header-nav__link']} ${styles['header-nav__link--account']}`}>\n                    Sign out\n                  </Link>\n              }\n              {\n                isLoggedIn && initials &&\n                <Link to={'/account'} className={`hide-large ${styles['profile-badge']}`}>\n                  <span className={styles['profile-badge__initials']}>{initials}</span>\n                </Link>\n              }\n              </li>\n            </>\n            }\n\n          </ul>\n        </nav>\n\n        <button className={`${styles['menu-button']} ${isOpenClass}`} onClick={() => handleMobileMenuClick()}>\n          <span className=\"screen-reader-text\">Menu</span>\n          <span className={styles['menu-button__burger-icon']}></span>\n        </button>\n      </div>\n    </header >\n  )\n}\n\nexport default memo(Header)\n"]},"metadata":{},"sourceType":"module"}