{"ast":null,"code":"var _jsxFileName = \"/Users/ognjen/Desktop/spooky-live-ssr/ui/src/components/PurchaseButton/PurchaseButton.tsx\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Button from '../Button/Button';\nimport { VideoStreamStatus } from '../../services/content/tags/models';\nimport { selectVideoStreamStatus } from '../../services/content/tags/selectors';\nimport { showPurchaseModalToggledEvent } from '../../services/payments/purchase/events';\nimport { selectHasProduct } from '../../services/payments/subscriptions/selectors';\nimport { selectGamePassPriceFormatted } from '../../services/payments/products/selectors';\nimport { selectIsLoggedIn } from '../../services/userSecurity/token/selectors';\nimport { accountToggleLoginEvent } from '../../services/userSecurity/accountDetails/events';\n\nconst PurchaseButton = props => {\n  var _props$mainTag$pricin;\n\n  const labelStyle = {\n    width: '100%'\n  };\n  const seasonPassPrice = props.mainTag ? `$${(((_props$mainTag$pricin = props.mainTag.pricing) !== null && _props$mainTag$pricin !== void 0 ? _props$mainTag$pricin : 2995) / 100).toString()}` : '$29.95';\n  const isLoggedIn = useSelector(state => selectIsLoggedIn(state.userSecurity.token));\n  const gamePassPrice = useSelector(state => selectGamePassPriceFormatted(state.payments.products, state.configuration));\n  const {\n    stream,\n    mainTag\n  } = props;\n  const dispatch = useDispatch();\n  const streamStatus = useSelector(state => selectVideoStreamStatus(state, stream));\n  const hasProduct = useSelector(state => selectHasProduct(state.payments.subscriptions, (mainTag === null || mainTag === void 0 ? void 0 : mainTag.stripeProductId) || '', state.configuration));\n\n  const renderButtons = () => {\n    return __jsx(React.Fragment, null, __jsx(\"p\", {\n      style: labelStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }\n    }, \"You can unlock this stream by purchasing it as one-off, or by subscribing to our monthly watch it all plan, or through it's tournament page.\"), __jsx(\"p\", {\n      style: {\n        width: '100%',\n        justifyContent: (mainTag === null || mainTag === void 0 ? void 0 : mainTag.stripeProductId) ? '' : 'flex-end'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }\n    }, ((mainTag === null || mainTag === void 0 ? void 0 : mainTag.stripeProductId) || stream) && __jsx(Button, {\n      onClick: () => handleClick(mainTag === null || mainTag === void 0 ? void 0 : mainTag.stripeProductId, (mainTag === null || mainTag === void 0 ? void 0 : mainTag.id) || undefined, stream === null || stream === void 0 ? void 0 : stream.eventId),\n      type: \"submit\",\n      variant: \"secondary\",\n      color: \"ghost-green\",\n      label: `Purchase for ${mainTag ? seasonPassPrice : gamePassPrice}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 13\n      }\n    }), __jsx(Button, {\n      style: {\n        flex: (mainTag === null || mainTag === void 0 ? void 0 : mainTag.stripeProductId) ? '1' : '.4'\n      },\n      onClick: () => handleClick(undefined, undefined, undefined),\n      type: \"submit\",\n      variant: \"secondary\",\n      color: \"success\",\n      label: \"Subscribe to watch it all\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 11\n      }\n    })));\n  };\n\n  const handleClick = (product, tag, eventId) => {\n    if (!isLoggedIn) {\n      dispatch(accountToggleLoginEvent(() => showPurchaseModalToggledEvent(product, tag, eventId)));\n    } else {\n      dispatch(showPurchaseModalToggledEvent(product, tag, eventId));\n    }\n  };\n\n  if (streamStatus === VideoStreamStatus.FreeNotLoggedIn) return __jsx(React.Fragment, null);\n  if (streamStatus === VideoStreamStatus.Free || hasProduct || streamStatus === VideoStreamStatus.Purchased) return __jsx(React.Fragment, null);\n\n  if (!hasProduct || streamStatus === VideoStreamStatus.NotPurchased || streamStatus === VideoStreamStatus.NotPurchasedNotLoggedIn) {\n    if (props.classNames) return __jsx(\"div\", {\n      className: props.classNames,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }\n    }, renderButtons());\n    return renderButtons();\n  }\n\n  return __jsx(React.Fragment, null);\n};\n\nexport default PurchaseButton;","map":{"version":3,"sources":["/Users/ognjen/Desktop/spooky-live-ssr/ui/src/components/PurchaseButton/PurchaseButton.tsx"],"names":["React","useDispatch","useSelector","Button","VideoStreamStatus","selectVideoStreamStatus","showPurchaseModalToggledEvent","selectHasProduct","selectGamePassPriceFormatted","selectIsLoggedIn","accountToggleLoginEvent","PurchaseButton","props","labelStyle","width","seasonPassPrice","mainTag","pricing","toString","isLoggedIn","state","userSecurity","token","gamePassPrice","payments","products","configuration","stream","dispatch","streamStatus","hasProduct","subscriptions","stripeProductId","renderButtons","justifyContent","handleClick","id","undefined","eventId","flex","product","tag","FreeNotLoggedIn","Free","Purchased","NotPurchased","NotPurchasedNotLoggedIn","classNames"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,SAAwBC,iBAAxB,QAAiD,oCAAjD;AAEA,SAASC,uBAAT,QAAwC,uCAAxC;AACA,SAASC,6BAAT,QAA8C,yCAA9C;AACA,SAASC,gBAAT,QAAiC,iDAAjC;AACA,SAASC,4BAAT,QAA6E,4CAA7E;AACA,SAASC,gBAAT,QAAiC,6CAAjC;AACA,SAASC,uBAAT,QAAwC,mDAAxC;;AAQA,MAAMC,cAA8C,GAAIC,KAAD,IAAiC;AAAA;;AAEtF,QAAMC,UAAU,GAAG;AACjBC,IAAAA,KAAK,EAAE;AADU,GAAnB;AAIA,QAAMC,eAAe,GAAGH,KAAK,CAACI,OAAN,GACrB,IAAG,CAAC,0BAACJ,KAAK,CAACI,OAAN,CAAcC,OAAf,yEAA0B,IAA1B,IAAkC,GAAnC,EAAwCC,QAAxC,EAAmD,EADjC,GACqC,QAD7D;AAGA,QAAMC,UAAU,GAAGjB,WAAW,CAAqBkB,KAAK,IAAIX,gBAAgB,CAACW,KAAK,CAACC,YAAN,CAAmBC,KAApB,CAA9C,CAA9B;AAEA,QAAMC,aAAa,GAAGrB,WAAW,CAAoBkB,KAAK,IAAIZ,4BAA4B,CAACY,KAAK,CAACI,QAAN,CAAeC,QAAhB,EAA0BL,KAAK,CAACM,aAAhC,CAAzD,CAAjC;AACA,QAAM;AAAEC,IAAAA,MAAF;AAAUX,IAAAA;AAAV,MAAsBJ,KAA5B;AACA,QAAMgB,QAAQ,GAAG3B,WAAW,EAA5B;AACA,QAAM4B,YAAY,GAAG3B,WAAW,CAA+BkB,KAAK,IAAIf,uBAAuB,CAACe,KAAD,EAAQO,MAAR,CAA/D,CAAhC;AACA,QAAMG,UAAU,GAAG5B,WAAW,CAAqBkB,KAAK,IAAIb,gBAAgB,CAACa,KAAK,CAACI,QAAN,CAAeO,aAAhB,EAA+B,CAAAf,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,eAAT,KAA4B,EAA3D,EAA+DZ,KAAK,CAACM,aAArE,CAA9C,CAA9B;;AAEA,QAAMO,aAAa,GAAG,MAAM;AAC1B,WACE,4BACE;AAAG,MAAA,KAAK,EAAEpB,UAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sJADF,EAIE;AAAG,MAAA,KAAK,EAAE;AAACC,QAAAA,KAAK,EAAE,MAAR;AAAgBoB,QAAAA,cAAc,EAAE,CAAAlB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,eAAT,IAA2B,EAA3B,GAAgC;AAAhE,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEI,CAAC,CAAAhB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,eAAT,KAA4BL,MAA7B,KACA,MAAC,MAAD;AACE,MAAA,OAAO,EAAE,MAAMQ,WAAW,CAACnB,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEgB,eAAV,EAA2B,CAAAhB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEoB,EAAT,KAAeC,SAA1C,EAAqDV,MAArD,aAAqDA,MAArD,uBAAqDA,MAAM,CAAEW,OAA7D,CAD5B;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,OAAO,EAAC,WAHV;AAIE,MAAA,KAAK,EAAC,aAJR;AAKE,MAAA,KAAK,EAAG,gBAAetB,OAAO,GAAGD,eAAH,GAAqBQ,aAAc,EALnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHJ,EAWE,MAAC,MAAD;AACE,MAAA,KAAK,EAAE;AAACgB,QAAAA,IAAI,EAAE,CAAAvB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,eAAT,IAA4B,GAA5B,GAAkC;AAAzC,OADT;AAEE,MAAA,OAAO,EAAE,MAAMG,WAAW,CAACE,SAAD,EAAYA,SAAZ,EAAuBA,SAAvB,CAF5B;AAGE,MAAA,IAAI,EAAC,QAHP;AAIE,MAAA,OAAO,EAAC,WAJV;AAKE,MAAA,KAAK,EAAC,SALR;AAME,MAAA,KAAK,EAAC,2BANR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXF,CAJF,CADF;AA2BD,GA5BD;;AA6BA,QAAMF,WAAW,GAAG,CAACK,OAAD,EAAUC,GAAV,EAAeH,OAAf,KAA2B;AAC7C,QAAI,CAACnB,UAAL,EAAiB;AACfS,MAAAA,QAAQ,CAAClB,uBAAuB,CAAC,MAAMJ,6BAA6B,CAACkC,OAAD,EAAUC,GAAV,EAAeH,OAAf,CAApC,CAAxB,CAAR;AACD,KAFD,MAGK;AACHV,MAAAA,QAAQ,CAACtB,6BAA6B,CAACkC,OAAD,EAAUC,GAAV,EAAeH,OAAf,CAA9B,CAAR;AACD;AACF,GAPD;;AASA,MAAIT,YAAY,KAAKzB,iBAAiB,CAACsC,eAAvC,EACE,OACE,2BADF;AAMF,MAAIb,YAAY,KAAKzB,iBAAiB,CAACuC,IAAnC,IAA4Cb,UAAU,IAAID,YAAY,KAAKzB,iBAAiB,CAACwC,SAAjG,EACE,OACE,2BADF;;AAMF,MAAI,CAACd,UAAD,IAAeD,YAAY,KAAKzB,iBAAiB,CAACyC,YAAlD,IAAkEhB,YAAY,KAAKzB,iBAAiB,CAAC0C,uBAAzG,EAAkI;AAEhI,QAAIlC,KAAK,CAACmC,UAAV,EACE,OACE;AAAK,MAAA,SAAS,EAAEnC,KAAK,CAACmC,UAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGd,aAAa,EADhB,CADF;AAMF,WACEA,aAAa,EADf;AAGD;;AACD,SAAO,2BAAP;AACD,CAnFD;;AAqFA,eAAetB,cAAf","sourcesContent":["import React from 'react'\nimport { useDispatch, useSelector } from 'react-redux';\nimport Button from '../Button/Button'\nimport { IStream, ITag, VideoStreamStatus } from '../../services/content/tags/models'\nimport { RootState } from '../../services/RootState';\nimport { selectVideoStreamStatus } from '../../services/content/tags/selectors'\nimport { showPurchaseModalToggledEvent } from '../../services/payments/purchase/events';\nimport { selectHasProduct } from '../../services/payments/subscriptions/selectors';\nimport { selectGamePassPriceFormatted, selectSeasonPassPriceFormatted } from '../../services/payments/products/selectors';\nimport { selectIsLoggedIn } from '../../services/userSecurity/token/selectors';\nimport { accountToggleLoginEvent } from '../../services/userSecurity/accountDetails/events';\n\ninterface IPurchaseButtonProps {\n  stream: IStream | undefined\n  mainTag: ITag | undefined,\n  classNames?: string | undefined\n}\n\nconst PurchaseButton: React.FC<IPurchaseButtonProps> = (props: IPurchaseButtonProps) => {\n\n  const labelStyle = {\n    width: '100%',\n  };\n\n  const seasonPassPrice = props.mainTag ? \n    `$${((props.mainTag.pricing ?? 2995) / 100).toString()}` : '$29.95';\n  \n  const isLoggedIn = useSelector<RootState, boolean>(state => selectIsLoggedIn(state.userSecurity.token))\n\n  const gamePassPrice = useSelector<RootState, string>(state => selectGamePassPriceFormatted(state.payments.products, state.configuration));\n  const { stream, mainTag } = props\n  const dispatch = useDispatch()\n  const streamStatus = useSelector<RootState, VideoStreamStatus>(state => selectVideoStreamStatus(state, stream))\n  const hasProduct = useSelector<RootState, boolean>(state => selectHasProduct(state.payments.subscriptions, mainTag?.stripeProductId || '', state.configuration))\n\n  const renderButtons = () => {\n    return (\n      <>\n        <p style={labelStyle}>\n          You can unlock this stream by purchasing it as one-off, or by subscribing to our monthly watch it all plan, or through it's tournament page.\n        </p>\n        <p style={{width: '100%', justifyContent: mainTag?.stripeProductId ? '' : 'flex-end'}}>\n          {\n            (mainTag?.stripeProductId || stream) &&\n            <Button\n              onClick={() => handleClick(mainTag?.stripeProductId, mainTag?.id || undefined, stream?.eventId)}\n              type=\"submit\"\n              variant=\"secondary\"\n              color=\"ghost-green\"\n              label={`Purchase for ${mainTag ? seasonPassPrice : gamePassPrice}`}\n            />\n          }\n          <Button\n            style={{flex: mainTag?.stripeProductId ?  '1' : '.4'}}\n            onClick={() => handleClick(undefined, undefined, undefined)}\n            type=\"submit\"\n            variant=\"secondary\"\n            color=\"success\"\n            label=\"Subscribe to watch it all\"\n          />\n        </p>\n      </>\n    )\n  }\n  const handleClick = (product, tag, eventId) => {\n    if (!isLoggedIn) {\n      dispatch(accountToggleLoginEvent(() => showPurchaseModalToggledEvent(product, tag, eventId)));\n    }\n    else {\n      dispatch(showPurchaseModalToggledEvent(product, tag, eventId));\n    }\n  }\n  \n  if (streamStatus === VideoStreamStatus.FreeNotLoggedIn)\n    return (\n      <>\n       \n      </>\n    )\n\n  if (streamStatus === VideoStreamStatus.Free || (hasProduct || streamStatus === VideoStreamStatus.Purchased))\n    return (\n      <>\n      </>\n    )\n\n  \n  if (!hasProduct || streamStatus === VideoStreamStatus.NotPurchased || streamStatus === VideoStreamStatus.NotPurchasedNotLoggedIn) {\n    \n    if (props.classNames) \n      return (\n        <div className={props.classNames}>\n          {renderButtons()}\n        </div>\n      )\n    \n    return (\n      renderButtons()\n    )\n  }\n  return <></>\n}\n\nexport default PurchaseButton"]},"metadata":{},"sourceType":"module"}