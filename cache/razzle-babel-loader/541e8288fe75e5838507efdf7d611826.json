{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { memo, useEffect, useState } from 'react';\nimport styles from './Header.module.scss';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport moment from 'moment';\nimport LiveLogo from '../../svg/images/live-logo.svg';\nimport { selectIsLoggedIn, selectIsTokenValid } from '../../services/userSecurity/token/selectors';\nimport { selectInitials } from '../../services/userSecurity/profile/selectors';\nimport { tokenRemovedEvent, tokenRefreshTokenRequestedEvent } from '../../services/userSecurity/token/events';\nimport { tagsRequestedEvent } from '../../services/content/tags/events';\nimport { v4 as uuidv4 } from 'uuid';\nimport Button from '../Button/Button';\nimport { accountToggleLoginEvent, accountToggleSignupEvent } from '../../services/userSecurity/accountDetails/events';\nimport { showPurchaseModalToggledEvent } from '../../services/payments/purchase/events';\n\nvar Header = function Header(props) {\n  var currentPathName = useSelector(function (state) {\n    return state.router.location.pathname;\n  });\n  var isLoggedIn = useSelector(function (state) {\n    return selectIsLoggedIn(state.userSecurity.token);\n  });\n  var isTokenValid = useSelector(function (state) {\n    return selectIsTokenValid(state.userSecurity.token);\n  });\n  var initials = useSelector(function (state) {\n    return selectInitials(state.userSecurity.profile);\n  });\n  var profile = useSelector(function (state) {\n    return state.userSecurity.profile;\n  }); // let hasWathchItAll = useSelector<RootState, boolean>(state => selectHasWatchItAll(state.payments.subscriptions))\n\n  var streams = useSelector(function (state) {\n    return state.content.tags.streams;\n  });\n  var liveStreams = streams === null || streams === void 0 ? void 0 : streams.some(function (stream) {\n    var now = moment();\n    var streamStart = moment(stream.startTime);\n    var streamEnd = moment(stream.startTime).add(stream.duration, 'm');\n    var isActive = now.isBetween(streamStart, streamEnd);\n    return isActive;\n  });\n  var futureStreams = streams === null || streams === void 0 ? void 0 : streams.some(function (st) {\n    return moment().isSameOrBefore(st.startTime);\n  });\n  var hasWatchItAll = props.hasWatchItAll;\n  var dispatch = useDispatch();\n  useEffect(function () {\n    dispatch(tagsRequestedEvent());\n  }, [dispatch]);\n\n  if (profile.id !== null) {\n    if (!isTokenValid) {\n      dispatch(tokenRefreshTokenRequestedEvent()); // invalid token. refresh the token\n    } else {\n      dispatch({\n        type: 'TOKEN_PERSIST'\n      });\n    }\n  }\n\n  var _useState = useState(false),\n      showMobileMenu = _useState[0],\n      toggleMobileMenu = _useState[1];\n\n  var toggleLogin = function toggleLogin() {\n    dispatch(accountToggleLoginEvent());\n  };\n\n  var togglePremium = function togglePremium() {\n    dispatch(showPurchaseModalToggledEvent(undefined, undefined, undefined));\n  };\n\n  var toggleSignup = function toggleSignup() {\n    dispatch(accountToggleSignupEvent());\n  };\n\n  var handleMobileMenuClick = function handleMobileMenuClick() {\n    toggleMobileMenu(!showMobileMenu);\n  };\n\n  var handleMobileLogoClick = function handleMobileLogoClick() {\n    toggleMobileMenu(!showMobileMenu);\n  };\n\n  var signOut = function signOut() {\n    window.localStorage.clear();\n    dispatch(tokenRemovedEvent());\n  };\n\n  var isOpenClass = showMobileMenu ? styles['is-active'] : '';\n  var navConfig = [{\n    label: 'Home',\n    link: '/',\n    visible: true\n  }, {\n    label: 'Browse',\n    link: '/browse',\n    visible: true\n  }, {\n    label: 'Upcoming',\n    link: '/upcoming',\n    visible: futureStreams\n  }, {\n    label: 'Latest',\n    link: '/latest',\n    visible: true\n  }, {\n    label: 'My Streams',\n    link: '/my-streams',\n    visible: isLoggedIn\n  }, {\n    label: 'News',\n    link: '/news',\n    visible: false\n  }];\n\n  var isSelected = function isSelected(path) {\n    return path === currentPathName;\n  };\n\n  return __jsx(\"header\", {\n    className: styles.header,\n    id: \"top\"\n  }, __jsx(\"div\", {\n    className: \"container \".concat(styles.container)\n  }, !isOpenClass && __jsx(Link, {\n    to: '/',\n    className: styles.header__logo\n  }, __jsx(\"img\", {\n    src: LiveLogo,\n    alt: \"Live\"\n  })), isOpenClass && __jsx(Link, {\n    to: '',\n    onClick: function onClick() {\n      return handleMobileLogoClick();\n    },\n    className: styles.header__logo\n  }, __jsx(\"img\", {\n    src: LiveLogo,\n    alt: \"Live\"\n  })), __jsx(\"nav\", {\n    className: \"\".concat(styles['header-nav'], \" \").concat(isOpenClass),\n    onClick: function onClick() {\n      return handleMobileMenuClick();\n    }\n  }, __jsx(\"ul\", {\n    className: styles['header-nav__list']\n  }, !isLoggedIn && __jsx(React.Fragment, null, __jsx(\"li\", {\n    className: \"\".concat(styles['header-nav__list-item'], \" \").concat(styles['header-nav--mobile-show'])\n  }, __jsx(Link, {\n    to: \"#\",\n    onClick: function onClick() {\n      return toggleLogin();\n    },\n    className: \"\".concat(styles['header-nav__link'])\n  }, \"Log in\")), __jsx(\"li\", {\n    className: \"\".concat(styles['header-nav__list-item'], \" \").concat(styles['header-nav--mobile-show'])\n  }, __jsx(Link, {\n    to: \"#\",\n    className: \"\".concat(styles['header-nav__link'])\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: \"success\",\n    label: \"Sign up\",\n    onClick: toggleSignup\n  })))), isSelected('/live-now') ? __jsx(\"li\", {\n    className: styles['header-nav__list-item'],\n    key: uuidv4()\n  }, __jsx(\"span\", {\n    className: \"\".concat(styles['is-selected'], \" \").concat(styles['header-nav--mobile-hide'])\n  }, \"Live now\"), __jsx(Link, {\n    to: \"/live-now\",\n    className: \"\".concat(styles['header-nav__link'], \" \").concat(styles['header-nav__live-now-button'], \" \").concat(styles['header-nav--mobile-show'])\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: liveStreams ? \"success\" : \"ghost\",\n    label: \"live now\",\n    disabled: !liveStreams\n  }))) : __jsx(React.Fragment, null, liveStreams && __jsx(\"li\", {\n    className: styles['header-nav__list-item'],\n    key: uuidv4()\n  }, __jsx(Link, {\n    to: \"/live-now\",\n    className: \"\".concat(styles['header-nav__link'], \" \").concat(styles['header-nav__live-now-button'])\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: liveStreams ? \"success\" : \"ghost\",\n    label: \"live now\",\n    disabled: !liveStreams\n  })))), navConfig.map(function (_ref) {\n    var label = _ref.label,\n        link = _ref.link,\n        visible = _ref.visible;\n    return visible && __jsx(\"li\", {\n      className: styles['header-nav__list-item'],\n      key: uuidv4()\n    }, __jsx(Link, {\n      to: link,\n      className: styles['header-nav__link']\n    }, __jsx(\"span\", {\n      className: isSelected(link) ? styles['is-selected'] : ''\n    }, label)));\n  })), __jsx(\"ul\", {\n    className: styles['header-nav__list']\n  }, !isLoggedIn && __jsx(React.Fragment, null, __jsx(\"li\", {\n    className: \"\".concat(styles['header-nav__list-item'], \" \").concat(styles['header-nav--mobile-hide'])\n  }, __jsx(Link, {\n    to: \"#\",\n    onClick: function onClick() {\n      return toggleLogin();\n    },\n    className: \"\".concat(styles['header-nav__link'], \" \").concat(styles['header-nav__login-button'])\n  }, \"Log in\")), __jsx(\"li\", {\n    className: \"\".concat(styles['header-nav__list-item'], \" \").concat(styles['header-nav--mobile-hide'])\n  }, __jsx(Link, {\n    to: \"#\",\n    className: \"\".concat(styles['header-nav__link'], \" \").concat(styles['header-nav__login-button'])\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    color: \"success\",\n    label: \"Sign up\",\n    onClick: toggleSignup\n  })))), isLoggedIn && __jsx(React.Fragment, null, !hasWatchItAll && __jsx(\"li\", {\n    className: \"\".concat(styles['header-nav__list-item'], \" \").concat(styles['header-nav__list-item--account'])\n  }, __jsx(Link, {\n    to: '#',\n    onClick: togglePremium,\n    className: \" \".concat(styles['header-nav__link'], \" \").concat(styles['header-nav--green'], \" \").concat(styles['header-nav__link--account'])\n  }, \"Go Premium\")), __jsx(\"li\", {\n    className: \"\".concat(styles['header-nav__list-item'], \" \").concat(styles['header-nav__list-item--account'])\n  }, isLoggedIn && initials && __jsx(Link, {\n    to: '/account',\n    className: \"show-large \".concat(styles['header-nav__link'], \" \").concat(styles['header-nav__link--account'])\n  }, \"Account\"), isLoggedIn && __jsx(Link, {\n    to: \"\",\n    onClick: signOut,\n    className: \"\".concat(styles['header-nav__link'], \" \").concat(styles['header-nav__link--account'])\n  }, \"Sign out\"), isLoggedIn && initials && __jsx(Link, {\n    to: '/account',\n    className: \"hide-large \".concat(styles['profile-badge'])\n  }, __jsx(\"span\", {\n    className: styles['profile-badge__initials']\n  }, initials)))))), __jsx(\"button\", {\n    className: \"\".concat(styles['menu-button'], \" \").concat(isOpenClass),\n    onClick: function onClick() {\n      return handleMobileMenuClick();\n    }\n  }, __jsx(\"span\", {\n    className: \"screen-reader-text\"\n  }, \"Menu\"), __jsx(\"span\", {\n    className: styles['menu-button__burger-icon']\n  }))));\n};\n\nexport default /*#__PURE__*/memo(Header);","map":{"version":3,"sources":["/Users/ognjen/Desktop/spooky-live-ssr/ui/src/components/Header/Header.tsx"],"names":["React","memo","useEffect","useState","styles","useDispatch","useSelector","Link","moment","LiveLogo","selectIsLoggedIn","selectIsTokenValid","selectInitials","tokenRemovedEvent","tokenRefreshTokenRequestedEvent","tagsRequestedEvent","v4","uuidv4","Button","accountToggleLoginEvent","accountToggleSignupEvent","showPurchaseModalToggledEvent","Header","props","currentPathName","state","router","location","pathname","isLoggedIn","userSecurity","token","isTokenValid","initials","profile","streams","content","tags","liveStreams","some","stream","now","streamStart","startTime","streamEnd","add","duration","isActive","isBetween","futureStreams","st","isSameOrBefore","hasWatchItAll","dispatch","id","type","showMobileMenu","toggleMobileMenu","toggleLogin","togglePremium","undefined","toggleSignup","handleMobileMenuClick","handleMobileLogoClick","signOut","window","localStorage","clear","isOpenClass","navConfig","label","link","visible","isSelected","path","header","container","header__logo","map"],"mappings":"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","sourcesContent":["import React, { memo, useEffect, useState } from 'react'\nimport styles from './Header.module.scss'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport moment from 'moment'\nimport LiveLogo from '../../svg/images/live-logo.svg'\nimport { RootState } from '../../services/RootState'\nimport { selectIsLoggedIn, selectIsTokenValid } from '../../services/userSecurity/token/selectors'\nimport { selectInitials, selectIntercomInfo } from '../../services/userSecurity/profile/selectors'\nimport { tokenRemovedEvent, tokenRefreshTokenRequestedEvent } from '../../services/userSecurity/token/events'\nimport { configRequestedEvent } from '../../services/config/events'\nimport { tagsRequestedEvent } from '../../services/content/tags/events'\nimport { selectHasWatchItAll } from '../../services/payments/subscriptions/selectors'\nimport { v4 as uuidv4 } from 'uuid'\nimport Button from '../Button/Button'\nimport { IStream } from '../../services/content/tags/models'\nimport { profileReceivedEvent } from '../../services/userSecurity/profile/events'\nimport { ProfileState } from '../../services/userSecurity/profile/models'\nimport { accountToggleLoginEvent, accountToggleSignupEvent } from '../../services/userSecurity/accountDetails/events'\nimport { showPurchaseModalToggledEvent } from '../../services/payments/purchase/events'\n\nexport interface IHeaderProps {\n  hasWatchItAll: boolean\n}\n\n\nconst Header: React.FC<IHeaderProps> = (props) => {\n\n  let currentPathName = useSelector<RootState, string>((state) => state.router.location.pathname)\n  let isLoggedIn = useSelector<RootState, boolean>((state) => selectIsLoggedIn(state.userSecurity.token))\n  let isTokenValid = useSelector<RootState, boolean>((state) => selectIsTokenValid(state.userSecurity.token));\n  let initials = useSelector<RootState, string>((state) => selectInitials(state.userSecurity.profile))\n  let profile = useSelector<RootState, ProfileState>((state => state.userSecurity.profile));\n\n  // let hasWathchItAll = useSelector<RootState, boolean>(state => selectHasWatchItAll(state.payments.subscriptions))\n  const streams = useSelector<RootState, IStream[] | undefined>(state => state.content.tags.streams)\n\n  const liveStreams = streams?.some(stream => {\n    let now = moment()\n    let streamStart = moment(stream.startTime)\n    let streamEnd = moment(stream.startTime).add(stream.duration, 'm')\n    let isActive = now.isBetween(streamStart, streamEnd)\n\n    return isActive\n  })\n  const futureStreams = streams?.some(st => moment().isSameOrBefore(st.startTime));\n\n  const { hasWatchItAll } = props\n\n  const dispatch = useDispatch()\n\n  useEffect(() => {\n    dispatch(tagsRequestedEvent());\n  }, [dispatch]);\n\nif (profile.id !== null) {\n  if (!isTokenValid) {\n    dispatch(tokenRefreshTokenRequestedEvent()) // invalid token. refresh the token\n  } else {\n    dispatch({\n      type: 'TOKEN_PERSIST'\n    })\n  }\n}\n  const [showMobileMenu, toggleMobileMenu] = useState(false);\n\n  const toggleLogin = () => {\n    dispatch(accountToggleLoginEvent());\n  }\n  const togglePremium = () => {\n    dispatch(showPurchaseModalToggledEvent(undefined, undefined, undefined));\n  }\n  const toggleSignup = () => {\n    dispatch(accountToggleSignupEvent());\n  }\n  const handleMobileMenuClick = () => {\n    toggleMobileMenu(!showMobileMenu)\n  }\n  const handleMobileLogoClick = () => {\n    toggleMobileMenu(!showMobileMenu);\n\n  }\n  const signOut = () => {\n    window.localStorage.clear();\n    dispatch(tokenRemovedEvent());\n  }\n\n  const isOpenClass = showMobileMenu ? styles['is-active'] : '';\n\n  const navConfig = [\n    {\n      label: 'Home',\n      link: '/',\n      visible: true,\n    }, {\n      label: 'Browse',\n      link: '/browse',\n      visible: true,\n    }, {\n      label: 'Upcoming',\n      link: '/upcoming',\n      visible: futureStreams,\n    }, {\n      label: 'Latest',\n      link: '/latest',\n      visible: true,\n    }, {\n      label: 'My Streams',\n      link: '/my-streams',\n      visible: isLoggedIn,\n    }, {\n      label: 'News',\n      link: '/news',\n      visible: false,\n    },\n  ]\n\n  const isSelected = (path) => path === currentPathName\n\n\n  return (\n    <header className={styles.header} id=\"top\">\n      <div className={`container ${styles.container}`}>\n        {!isOpenClass &&\n          <Link to={'/'} className={styles.header__logo}>\n\n            <img src={LiveLogo} alt=\"Live\" />\n\n          </Link>}\n        {isOpenClass &&\n          <Link to={''} onClick={() => handleMobileLogoClick()} className={styles.header__logo}>\n\n            <img src={LiveLogo} alt=\"Live\" />\n\n          </Link>}\n        <nav className={`${styles['header-nav']} ${isOpenClass}`} onClick={() => handleMobileMenuClick()}>\n          <ul className={styles['header-nav__list']}>\n\n            {!isLoggedIn &&\n              <>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-show']}`}>\n                  <Link to='#' onClick={() => toggleLogin()} \n                    className={`${styles['header-nav__link']}`}>\n                      Log in\n                    </Link>\n                </li>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-show']}`}>\n                <Link\n                    to='#'\n                    className={`${styles['header-nav__link']}`}\n                  >\n                    <Button\n                      variant=\"secondary\"\n                      color=\"success\"\n                      label=\"Sign up\"\n                      onClick={toggleSignup}\n                    />\n                  </Link>\n                </li>\n              </>\n            }\n\n            {isSelected('/live-now') ? (\n              <li className={styles['header-nav__list-item']} key={uuidv4()}>\n                <span className={`${styles['is-selected']} ${styles['header-nav--mobile-hide']}`}>\n                  Live now\n                </span>\n\n                <Link to=\"/live-now\" className={`${styles['header-nav__link']} ${styles['header-nav__live-now-button']} ${styles['header-nav--mobile-show']}`}>\n                  <Button\n                    variant=\"secondary\"\n                    color={liveStreams ? \"success\" : \"ghost\"}\n                    label=\"live now\"\n                    disabled={!liveStreams}\n                  />\n                </Link>\n              </li>\n            ) :\n              <>\n                {liveStreams &&\n                  <li className={styles['header-nav__list-item']} key={uuidv4()}>\n                    <Link to=\"/live-now\" className={`${styles['header-nav__link']} ${styles['header-nav__live-now-button']}`}>\n                      <Button\n                        variant=\"secondary\"\n                        color={liveStreams ? \"success\" : \"ghost\"}\n                        label=\"live now\"\n                        disabled={!liveStreams}\n                      />\n                    </Link>\n                  </li>\n                }\n              </>\n            }\n            {navConfig.map(({ label, link, visible }) => visible &&\n              <li className={styles['header-nav__list-item']} key={uuidv4()}>\n                <Link to={link} className={styles['header-nav__link']}>\n                  <span className={isSelected(link) ? styles['is-selected'] : ''}>\n                    {label}\n                  </span>\n                </Link>\n              </li>\n            )}\n\n          </ul>\n\n          <ul className={styles['header-nav__list']}>\n\n            {!isLoggedIn &&\n              <>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-hide']}`}>\n                  <Link to='#' onClick={() => toggleLogin()} \n                    className={`${styles['header-nav__link']} ${styles['header-nav__login-button']}`}>\n                      Log in\n                    </Link>\n                </li>\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav--mobile-hide']}`}>\n                  <Link\n                    to='#'\n                    className={`${styles['header-nav__link']} ${styles['header-nav__login-button']}`}\n                  >\n                    <Button\n                      variant=\"secondary\"\n                      color=\"success\"\n                      label=\"Sign up\"\n                      onClick={toggleSignup}\n                    />\n                  </Link>\n                </li>\n              </>\n            }\n\n            {isLoggedIn &&\n            \n            <>\n              { !hasWatchItAll &&\n                <li className={`${styles['header-nav__list-item']} ${styles['header-nav__list-item--account']}`}>\n                  <Link to={'#'} onClick={togglePremium} className={` ${styles['header-nav__link']} ${styles['header-nav--green']} ${styles['header-nav__link--account']}`}>\n                    Go Premium\n                  </Link>\n                </li>\n              }\n              <li className={`${styles['header-nav__list-item']} ${styles['header-nav__list-item--account']}`}>\n              {\n                isLoggedIn && initials &&\n                  <Link to={'/account'} className={`show-large ${styles['header-nav__link']} ${styles['header-nav__link--account']}`}>\n                    Account\n                  </Link>\n              }\n              {\n                isLoggedIn &&\n                  <Link to='' onClick={signOut} className={`${styles['header-nav__link']} ${styles['header-nav__link--account']}`}>\n                    Sign out\n                  </Link>\n              }\n              {\n                isLoggedIn && initials &&\n                <Link to={'/account'} className={`hide-large ${styles['profile-badge']}`}>\n                  <span className={styles['profile-badge__initials']}>{initials}</span>\n                </Link>\n              }\n              </li>\n            </>\n            }\n\n          </ul>\n        </nav>\n\n        <button className={`${styles['menu-button']} ${isOpenClass}`} onClick={() => handleMobileMenuClick()}>\n          <span className=\"screen-reader-text\">Menu</span>\n          <span className={styles['menu-button__burger-icon']}></span>\n        </button>\n      </div>\n    </header >\n  )\n}\n\nexport default memo(Header)\n"]},"metadata":{},"sourceType":"module"}