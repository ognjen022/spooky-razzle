{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport moment from 'moment';\nimport SaveStreamButton from '../SaveButtons/SaveStreamButton';\nimport { filterStreams, getTagsFull, selectVideoStreamStatus, isStreamLive } from '../../services/content/tags/selectors';\nimport PremiumContent from '../../components/PremiumContent/PremiumContent';\nimport PlayButton from '../../components/PlayButton/PlayButton';\nimport LineUpIcon from '../../components/LineUpIcon/LineUpIcon';\nimport { useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport LazyImage from '../LazyImage/LazyImage';\nimport VideoPlayerDefault from '../VideoPlayer/VideoPlayerDefault';\nimport { isIos, truncateString } from '../../utils/utils';\nimport { push } from 'connected-react-router';\n\nconst VideoSingleCarousel2 = props => {\n  var _props$filterTag, _props$filterTag2, _props$filterTag3, _props$filterTag4;\n\n  const isMobile = window.innerWidth <= 768;\n  const pathName = useSelector(state => {\n    var _state$router, _state$router$locatio;\n\n    return (_state$router = state.router) === null || _state$router === void 0 ? void 0 : (_state$router$locatio = _state$router.location) === null || _state$router$locatio === void 0 ? void 0 : _state$router$locatio.pathname;\n  });\n  let showSave = true;\n\n  if (isMobile) {\n    showSave = pathName !== '/my-streams';\n  }\n\n  const filteredStreams = filterStreams(props.streams, props.limit, props.filterTag);\n  const {\n    0: currentStreamIndex,\n    1: setCurrentStreamIndex\n  } = useState(0); // const [currentStream, setCurrentStream] = useState(allStreams[currentStreamIndex])\n\n  const videoStreamStatusFromRedux = useSelector(state => selectVideoStreamStatus(state, filteredStreams[currentStreamIndex]));\n  const {\n    0: videoStreamStatus,\n    1: setVideoStreamStatus\n  } = useState(videoStreamStatusFromRedux);\n  useEffect(() => {\n    setVideoStreamStatus(videoStreamStatusFromRedux);\n  }, [videoStreamStatusFromRedux]); // This will add support for multiple instances of Glide in the same page\n\n  const glideInstanceId = \"glide-id_\" + uuidv4();\n  const glideInstanceClassName = `.${glideInstanceId} .glide`;\n  useEffect(() => {\n    if (window.__NewGlide) {\n      var _props$streams;\n\n      if (((_props$streams = props.streams) === null || _props$streams === void 0 ? void 0 : _props$streams.length) > 0) {\n        let videoSingleCarouselGlide = window.__NewGlide(glideInstanceClassName, {\n          type: 'carousel',\n          hoverpause: true,\n          perView: 1,\n          animationTimingFunc: 'ease-in-out',\n          animationDuration: 1000,\n          breakpoints: {\n            768: {\n              animationTimingFunc: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)',\n              // default \n              animationDuration: 400\n            }\n          }\n        });\n\n        if (videoSingleCarouselGlide) {\n          videoSingleCarouselGlide.on(['mount.after', 'run'], function () {\n            let index = videoSingleCarouselGlide.index;\n            setCurrentStreamIndex(index);\n          });\n          if (filteredStreams.length > 1) videoSingleCarouselGlide.mount();\n        }\n      }\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []);\n  if (filteredStreams === undefined || (filteredStreams === null || filteredStreams === void 0 ? void 0 : filteredStreams.length) === 0) return __jsx(React.Fragment, null);\n\n  const renderSlide = (stream, index, lineUpTagsFull) => __jsx(\"li\", {\n    className: \"glide__slide\",\n    key: index\n  }, __jsx(\"div\", {\n    className: \"video-single-carousel__slider-inner\"\n  }, __jsx(ImageVideoSwitch, {\n    stream: stream,\n    index: currentStreamIndex,\n    showSave: showSave\n  }), __jsx(\"div\", {\n    className: \"video-single-carousel__content\"\n  }, __jsx(\"div\", {\n    className: \"video-single-carousel__content-inner\"\n  }, __jsx(\"h2\", null, __jsx(Link, {\n    to: `/play/${stream.eventId}`\n  }, __jsx(\"span\", {\n    className: \"line-clamp-3\"\n  }, truncateString(stream.name, 50)))), __jsx(\"p\", null, __jsx(\"span\", {\n    className: \"line-clamp-4\"\n  }, stream.description)), lineUpTagsFull && lineUpTagsFull.length > 0 && __jsx(\"ul\", {\n    className: \"teams-vs-list\"\n  }, lineUpTagsFull === null || lineUpTagsFull === void 0 ? void 0 : lineUpTagsFull.map((lineupTag, lineupIndex) => __jsx(\"li\", {\n    className: \"teams-vs-list__item\",\n    key: lineupIndex\n  }, __jsx(LineUpIcon, {\n    stream: stream,\n    className: 'teams-vs-list__image',\n    orderNumber: lineupIndex,\n    lineUpTagsFull: lineUpTagsFull\n  }), __jsx(\"span\", {\n    className: \"teams-vs-list__name\"\n  }, __jsx(Link, {\n    to: lineupTag.path || '#'\n  }, lineupTag.name)))))))));\n\n  return __jsx(\"section\", null, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: \"video-single-carousel\"\n  }, __jsx(\"div\", {\n    className: \"video-single-carousel__inner\"\n  }, __jsx(\"div\", {\n    className: \"video-single-carousel__controls\"\n  }, __jsx(\"div\", {\n    className: \"video-single-carousel__counter\"\n  }, __jsx(\"span\", {\n    className: \"video-single-carousel__counter-current\"\n  }, currentStreamIndex + 1, \" \"), \" / \", __jsx(\"span\", {\n    className: \"video-single-carousel__counter-total\"\n  }, filteredStreams === null || filteredStreams === void 0 ? void 0 : filteredStreams.length))), __jsx(\"div\", {\n    className: \"video-single-carousel__label\"\n  }, __jsx(Link, {\n    to: `${(_props$filterTag = props.filterTag) === null || _props$filterTag === void 0 ? void 0 : _props$filterTag.path}`\n  }, __jsx(\"span\", null, (_props$filterTag2 = props.filterTag) === null || _props$filterTag2 === void 0 ? void 0 : _props$filterTag2.name)), __jsx(Link, {\n    to: `${(_props$filterTag3 = props.filterTag) === null || _props$filterTag3 === void 0 ? void 0 : _props$filterTag3.path}`\n  }, __jsx(\"h2\", null, (_props$filterTag4 = props.filterTag) === null || _props$filterTag4 === void 0 ? void 0 : _props$filterTag4.name))), __jsx(\"div\", {\n    className: `video-single-carousel__slider ${glideInstanceId}`\n  }, __jsx(\"div\", {\n    className: \"glide\"\n  }, __jsx(\"div\", {\n    className: \"glide__track\",\n    \"data-glide-el\": \"track\"\n  }, __jsx(\"ul\", {\n    className: \"glide__slides\"\n  }, filteredStreams.map((stream, index) => renderSlide(stream, index, getTagsFull(stream.lineUpTags, props.uuidIndex))))), filteredStreams.length > 1 && __jsx(\"div\", {\n    \"data-glide-el\": \"controls\",\n    className: \"glide__arrows\"\n  }, __jsx(\"button\", {\n    \"data-glide-dir\": \"<\",\n    className: \"glide__button-prev\"\n  }, __jsx(\"svg\", {\n    className: \"icon\",\n    role: \"presentation\"\n  }, __jsx(\"use\", {\n    xlinkHref: \"#icon-chevron-left\"\n  })), __jsx(\"span\", {\n    className: \"screen-reader-text\"\n  }, \"Previous Slide\")), __jsx(\"button\", {\n    \"data-glide-dir\": \">\",\n    className: \"glide__button-next\"\n  }, __jsx(\"svg\", {\n    className: \"icon\",\n    role: \"presentation\"\n  }, __jsx(\"use\", {\n    xlinkHref: \"#icon-chevron-right\"\n  })), __jsx(\"span\", {\n    className: \"screen-reader-text\"\n  }, \"Next Slide\")))))))));\n};\n\nexport default VideoSingleCarousel2;\n\nconst ImageVideoSwitch = ({\n  stream,\n  index,\n  showSave\n}) => {\n  // const showPlayButton = stream && stream.startTime && moment(stream.startTime) < moment() && stream.videoStreams && stream.videoStreams.length > 0\n  const {\n    0: displayStream,\n    1: setDisplayStream\n  } = useState(false);\n\n  const openDisplayStream = () => {\n    push(`/play/${stream.eventId}`); //setDisplayStream(true)\n  };\n\n  const closeDisplayStream = () => {\n    setDisplayStream(false);\n  };\n\n  useEffect(() => {\n    closeDisplayStream();\n  }, [index]);\n\n  const getLivestreamEventId = stream => {\n    if (!stream || !stream.videoStreams || stream.videoStreams.length === 0) {\n      return '';\n    }\n\n    return stream.videoStreams[0].liveStreamEventId;\n  };\n\n  const getLiveEventVideoIdUrlParam = stream => {\n    if (!stream || !stream.videoStreams || stream.videoStreams.length === 0 || !stream.videoStreams[0].liveEventVideoId) {\n      return undefined;\n    }\n\n    return stream.videoStreams[0].liveEventVideoId;\n  };\n\n  const cropImageIfMobile = imageUri => {\n    const toMatch = [/Android/i, /webOS/i, /iPhone/i, /iPad/i, /iPod/i, /BlackBerry/i, /Windows Phone/i];\n\n    if (toMatch.some(item => navigator.userAgent.match(item))) {\n      return `${imageUri}?width=640&height=360&mode=crop`;\n    }\n\n    return `${imageUri}?width=1280&height=720&mode=crop`;\n  };\n\n  return __jsx(\"div\", {\n    className: 'video-single-carousel__image'\n  }, displayStream ? __jsx(React.Fragment, null, __jsx(\"button\", {\n    className: 'calendar-video__close-button',\n    onClick: closeDisplayStream\n  }, __jsx(\"svg\", {\n    className: \"icon\",\n    role: \"presentation\"\n  }, __jsx(\"use\", {\n    xlinkHref: \"#icon-mini-close\"\n  })), __jsx(\"span\", {\n    className: \"screen-reader-text\"\n  }, \"Close\")), stream.videoStreams && stream.videoStreams.length > 0 && __jsx(\"div\", {\n    className: \"aspect-ratio-16-9\"\n  }, __jsx(VideoPlayerDefault, {\n    onTimeUpdate: () => {},\n    position: 0,\n    isLive: true,\n    eventId: getLivestreamEventId(stream),\n    videoId: getLiveEventVideoIdUrlParam(stream)\n  }))) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"aspect-ratio-16-9\"\n  }, __jsx(Link, {\n    to: `/play/${stream.eventId}`\n  }, __jsx(LazyImage, {\n    src: cropImageIfMobile(stream.image ? `${stream.image}` : 'https://via.placeholder.com/2560x1440.png'),\n    alt: stream.name\n  }))), __jsx(\"div\", {\n    className: \"video-single-carousel__premium\"\n  }, __jsx(PremiumContent, {\n    stream: stream,\n    className: 'icon'\n  })), isStreamLive(stream.startTime, stream.duration) ? __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"video-single-carousel__live-indicator\"\n  }, __jsx(\"svg\", {\n    className: \"icon\",\n    role: \"presentation\"\n  }, __jsx(\"use\", {\n    xlinkHref: \"#icon-live\"\n  })), __jsx(\"span\", null, \"Live\"))) : __jsx(React.Fragment, null, showSave && __jsx(SaveStreamButton, {\n    stream: stream,\n    suffix: \"to My Stream\",\n    className: 'video-single-carousel__video-options-toggle'\n  })), __jsx(\"div\", {\n    className: \"video-single-carousel__date-time\"\n  }, __jsx(\"span\", {\n    className: \"video-single-carousel__date\"\n  }, moment(stream.startTime).format('ddd Do MMM YYYY'), __jsx(\"span\", {\n    className: \"video-single-carousel__time\"\n  }, \"- \", moment(stream.startTime).format('h.mm A')))), __jsx(PlayButton, {\n    stream: stream,\n    className: 'calendar-video__play-icon',\n    playStream: () => push(`/play/${stream.eventId}`),\n    mobileRedirectUrl: isIos() ? `/play/${stream.eventId}` : undefined\n  })));\n};","map":{"version":3,"sources":["/Users/ognjen/Desktop/spooky.live-ssr/src/components/VideoSingleCarousel/VideoSingleCarousel2.tsx"],"names":["React","useEffect","useState","v4","uuidv4","moment","SaveStreamButton","filterStreams","getTagsFull","selectVideoStreamStatus","isStreamLive","PremiumContent","PlayButton","LineUpIcon","useSelector","Link","LazyImage","VideoPlayerDefault","isIos","truncateString","push","VideoSingleCarousel2","props","isMobile","window","innerWidth","pathName","state","router","location","pathname","showSave","filteredStreams","streams","limit","filterTag","currentStreamIndex","setCurrentStreamIndex","videoStreamStatusFromRedux","videoStreamStatus","setVideoStreamStatus","glideInstanceId","glideInstanceClassName","__NewGlide","length","videoSingleCarouselGlide","type","hoverpause","perView","animationTimingFunc","animationDuration","breakpoints","on","index","mount","undefined","renderSlide","stream","lineUpTagsFull","eventId","name","description","map","lineupTag","lineupIndex","path","lineUpTags","uuidIndex","ImageVideoSwitch","displayStream","setDisplayStream","openDisplayStream","closeDisplayStream","getLivestreamEventId","videoStreams","liveStreamEventId","getLiveEventVideoIdUrlParam","liveEventVideoId","cropImageIfMobile","imageUri","toMatch","some","item","navigator","userAgent","match","image","startTime","duration","format"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { v4 as uuidv4 } from 'uuid';\nimport moment from 'moment'\n\nimport PurchaseButton from '../PurchaseButton/PurchaseButton'\nimport SaveStreamButton from '../SaveButtons/SaveStreamButton'\nimport { ITag, IStream, ITagIndex, VideoStreamStatus } from '../../services/content/tags/models'\nimport { filterStreams, getTagsFull, selectVideoStreamStatus, isStreamLive } from '../../services/content/tags/selectors'\nimport PremiumContent from '../../components/PremiumContent/PremiumContent'\nimport PlayButton from '../../components/PlayButton/PlayButton'\nimport LineUpIcon from '../../components/LineUpIcon/LineUpIcon'\nimport { showPurchaseModalToggledEvent } from '../../services/payments/purchase/events';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { RootState } from '../../services/RootState';\nimport LazyImage from '../LazyImage/LazyImage';\nimport VideoPlayer from '../VideoPlayer/VideoPlayer';\nimport VideoPlayerDefault from '../VideoPlayer/VideoPlayerDefault';\nimport { isIos, truncateString } from '../../utils/utils';\nimport { push } from 'connected-react-router';\n\ninterface VideoSingleCarousel2Props {\n  mainTag: ITag | undefined\n  streams: IStream[]\n  limit: number\n  filterTag: ITag | undefined\n  uuidIndex: ITagIndex[]\n}\n\nconst VideoSingleCarousel2: React.FC<VideoSingleCarousel2Props> = (props: VideoSingleCarousel2Props) => {\n\n  const isMobile = window.innerWidth <= 768;\n  const pathName = useSelector<RootState, any>(state => state.router?.location?.pathname)\n  let showSave = true;\n  if(isMobile) {\n    showSave = pathName !== '/my-streams';\n  }\n\n  const filteredStreams = filterStreams(props.streams, props.limit, props.filterTag)\n  const [currentStreamIndex, setCurrentStreamIndex] = useState(0)\n  // const [currentStream, setCurrentStream] = useState(allStreams[currentStreamIndex])\n  const videoStreamStatusFromRedux = useSelector<RootState, VideoStreamStatus>(state => selectVideoStreamStatus(state, filteredStreams[currentStreamIndex]))\n  const [videoStreamStatus, setVideoStreamStatus] = useState(videoStreamStatusFromRedux)\n\n  useEffect(() => {\n    setVideoStreamStatus(videoStreamStatusFromRedux)\n  }, [videoStreamStatusFromRedux])\n\n  // This will add support for multiple instances of Glide in the same page\n  const glideInstanceId = \"glide-id_\" + uuidv4();\n  const glideInstanceClassName = `.${glideInstanceId} .glide`\n\n  useEffect(() => {\n\n    if ((window as any).__NewGlide) {\n\n      if (props.streams?.length > 0) {\n\n        let videoSingleCarouselGlide: any = (window as any).__NewGlide(glideInstanceClassName, {\n          type: 'carousel',\n          hoverpause: true,\n          perView: 1,\n          animationTimingFunc: 'ease-in-out',\n          animationDuration: 1000,\n          breakpoints: {\n            768: {\n              animationTimingFunc: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)', // default \n              animationDuration: 400\n            }\n          }\n        })\n        if (videoSingleCarouselGlide) {\n\n\n          videoSingleCarouselGlide.on(['mount.after', 'run'], function () {\n            let index = videoSingleCarouselGlide.index;\n            setCurrentStreamIndex(index);\n          });\n\n          if (filteredStreams.length > 1)\n            videoSingleCarouselGlide.mount()\n        }\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  if (filteredStreams === undefined || filteredStreams?.length === 0) return (<></>)\n\n  const renderSlide = (stream: IStream, index: number, lineUpTagsFull: ITag[]) => (\n    \n    <li className=\"glide__slide\" key={index}>\n      <div className=\"video-single-carousel__slider-inner\">\n\n        <ImageVideoSwitch stream={stream} index={currentStreamIndex} showSave={showSave} />\n\n        <div className=\"video-single-carousel__content\">\n          <div className=\"video-single-carousel__content-inner\">\n            <h2><Link to={`/play/${stream.eventId}`}><span className=\"line-clamp-3\">{truncateString(stream.name, 50)}</span></Link></h2>\n            <p><span className=\"line-clamp-4\">{stream.description}</span></p>\n            {\n              lineUpTagsFull && lineUpTagsFull.length > 0 &&\n              <ul className=\"teams-vs-list\">\n                {\n                  lineUpTagsFull?.map((lineupTag, lineupIndex) => (\n                    <li className=\"teams-vs-list__item\" key={lineupIndex}>\n                      <LineUpIcon\n                        stream={stream}\n                        className={'teams-vs-list__image'}\n                        orderNumber={lineupIndex}\n                        lineUpTagsFull={lineUpTagsFull}\n                      />\n                      <span className=\"teams-vs-list__name\">\n                        <Link to={lineupTag.path || '#'}>{lineupTag.name}</Link>\n                      </span>\n                    </li>\n                  ))\n                }\n              </ul>\n            }\n          </div>\n          {/* { \n            stream.videoStreams && stream.videoStreams.length > 0 &&\n              <div className=\"video-single-carousel__content-footer\" id={`vsc2_div2_${uuidv4()}`}>\n                <PurchaseButton stream={stream} mainTag={undefined} />\n              </div>\n          } */}\n        </div>\n      </div>\n    </li>\n  )\n\n  return (\n    <section>\n      <div className=\"container\">\n        <div className=\"video-single-carousel\">\n          <div className=\"video-single-carousel__inner\">\n            <div className=\"video-single-carousel__controls\">\n              <div className=\"video-single-carousel__counter\">\n                <span className=\"video-single-carousel__counter-current\">{currentStreamIndex + 1} </span> / <span className=\"video-single-carousel__counter-total\">{filteredStreams?.length}</span>\n              </div>\n            </div>\n            <div className=\"video-single-carousel__label\">\n              <Link to={`${props.filterTag?.path}`}>\n                <span>{props.filterTag?.name}</span>\n              </Link>\n              <Link to={`${props.filterTag?.path}`}>\n                <h2>{props.filterTag?.name}</h2>\n              </Link>\n            </div>\n\n            <div className={`video-single-carousel__slider ${glideInstanceId}`} >\n              <div className=\"glide\">\n                <div className=\"glide__track\" data-glide-el=\"track\">\n                  <ul className=\"glide__slides\">\n                    {filteredStreams.map((stream, index) =>\n                      renderSlide(stream, index, getTagsFull(stream.lineUpTags, props.uuidIndex))\n                    )}\n                  </ul>\n                </div>\n                {filteredStreams.length > 1 &&\n                  <div data-glide-el=\"controls\" className=\"glide__arrows\">\n                    <button data-glide-dir=\"<\" className=\"glide__button-prev\">\n                      <svg className=\"icon\" role=\"presentation\">\n                        <use xlinkHref=\"#icon-chevron-left\"></use>\n                      </svg>\n                      <span className=\"screen-reader-text\">Previous Slide</span>\n                    </button>\n                    <button data-glide-dir=\">\" className=\"glide__button-next\">\n                      <svg className=\"icon\" role=\"presentation\">\n                        <use xlinkHref=\"#icon-chevron-right\"></use>\n                      </svg>\n                      <span className=\"screen-reader-text\">Next Slide</span>\n                    </button>\n                  </div>}\n              </div>\n            </div >\n          </div >\n        </div >\n      </div >\n    </section >\n  )\n}\n\nexport default VideoSingleCarousel2\n\ninterface IImageVideoSwitchProps {\n  stream: IStream\n  index: number\n  showSave: boolean\n}\n\nconst ImageVideoSwitch: React.FC<IImageVideoSwitchProps> = ({ stream, index, showSave }) => {\n  // const showPlayButton = stream && stream.startTime && moment(stream.startTime) < moment() && stream.videoStreams && stream.videoStreams.length > 0\n  const [displayStream, setDisplayStream] = useState<boolean>(false)\n\n  const openDisplayStream = () => {\n    push(`/play/${stream.eventId}`);//setDisplayStream(true)\n  }\n\n  const closeDisplayStream = () => {\n    setDisplayStream(false)\n  }\n\n  useEffect(() => {\n    closeDisplayStream();\n  }, [index])\n\n  const getLivestreamEventId = (stream: IStream): string => {\n    if (!stream || !stream.videoStreams || stream.videoStreams.length === 0) {\n      return ''\n    }\n\n    return stream.videoStreams[0].liveStreamEventId\n  }\n\n  const getLiveEventVideoIdUrlParam = (stream: IStream): number | undefined => {\n    if (!stream || !stream.videoStreams || stream.videoStreams.length === 0 || !stream.videoStreams[0].liveEventVideoId) {\n      return undefined\n    }\n\n    return stream.videoStreams[0].liveEventVideoId;\n  }\n\n  const cropImageIfMobile = (imageUri: string): string => {\n    const toMatch = [\n      /Android/i,\n      /webOS/i,\n      /iPhone/i,\n      /iPad/i,\n      /iPod/i,\n      /BlackBerry/i,\n      /Windows Phone/i\n    ];\n    if (toMatch.some((item) => navigator.userAgent.match(item))) {\n      return `${imageUri}?width=640&height=360&mode=crop`\n    }\n    return `${imageUri}?width=1280&height=720&mode=crop`;\n  }\n\n  return (\n    <div className={'video-single-carousel__image'}>\n      {displayStream ?\n        (\n          <>\n            <button className={'calendar-video__close-button'} onClick={closeDisplayStream}>\n              <svg className=\"icon\" role=\"presentation\">\n                <use xlinkHref=\"#icon-mini-close\"></use>\n              </svg>\n              <span className=\"screen-reader-text\">Close</span>\n            </button>\n            {stream.videoStreams && stream.videoStreams.length > 0 &&\n              <div className=\"aspect-ratio-16-9\">\n                {/* <iframe\n                  title=\"Video Player (VSC)\"\n                  className={'video-multi-carousel__iframe'}\n                  src={`/video-player/index.html?eventId=${getLivestreamEventId(stream)}${getLiveEventVideoIdUrlParam(stream)}`}\n                  allowFullScreen>\n                </iframe> */}\n                <VideoPlayerDefault\n                  onTimeUpdate={()=>{}}\n                  position={0}\n                  isLive={true}\n                  eventId={getLivestreamEventId(stream)}\n                  videoId={getLiveEventVideoIdUrlParam(stream)}></VideoPlayerDefault>\n\n              </div>\n            }\n          </>\n        )\n        :\n        (\n          <>\n            <div className=\"aspect-ratio-16-9\">\n              <Link to={`/play/${stream.eventId}`}>\n                <LazyImage src={cropImageIfMobile(stream.image ? `${stream.image}` : 'https://via.placeholder.com/2560x1440.png')} alt={stream.name} /></Link>\n            </div>\n            <div className=\"video-single-carousel__premium\">\n              <PremiumContent stream={stream} className={'icon'} />\n            </div>\n\n            {isStreamLive(stream.startTime, stream.duration) ?\n              <>\n                <div className=\"video-single-carousel__live-indicator\">\n                  <svg className=\"icon\" role=\"presentation\">\n                    <use xlinkHref=\"#icon-live\"></use>\n                  </svg>\n                  <span>Live</span>\n                </div>\n              </>\n              :\n              <>\n                {showSave &&\n                  <SaveStreamButton stream={stream} suffix=\"to My Stream\" className={'video-single-carousel__video-options-toggle'} />}\n              </>\n            }\n\n            <div className=\"video-single-carousel__date-time\">\n              <span className=\"video-single-carousel__date\">\n                {moment(stream.startTime).format('ddd Do MMM YYYY')}\n                <span className=\"video-single-carousel__time\">- {moment(stream.startTime).format('h.mm A')}</span>\n              </span>\n            </div>\n\n            <PlayButton\n              stream={stream}\n              className={'calendar-video__play-icon'}\n              playStream={() => push(`/play/${stream.eventId}`)}\n              mobileRedirectUrl={isIos() ?  `/play/${stream.eventId}` : undefined}\n            />\n\n          </>\n        )}\n    </div >\n  )\n}\n"]},"metadata":{},"sourceType":"module"}